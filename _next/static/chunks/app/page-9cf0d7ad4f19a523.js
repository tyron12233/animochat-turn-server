(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3287:()=>{},6379:(e,t,n)=>{Promise.resolve().then(n.bind(n,9677))},9677:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ep});var s=n(5155);function r(){return(0,s.jsxs)("div",{className:"fixed inset-0 overflow-hidden pointer-events-none -z-5",children:[(0,s.jsx)("div",{className:"absolute top-1/4 left-1/4 w-24 h-24 bg-gradient-to-r from-green-100 to-green-50 rounded-full opacity-50 animate-float mix-blend-multiply"}),(0,s.jsx)("div",{className:"absolute top-1/3 right-32 w-48 h-48 bg-green-100 rounded-full opacity-20 animate-blob animation-delay-2000"}),(0,s.jsx)("div",{className:"absolute top-2/3 left-16 w-16 h-16 bg-green-50 rotate-45 opacity-30 animate-float animation-delay-3000"}),(0,s.jsx)("div",{className:"absolute bottom-32 right-1/4",children:(0,s.jsx)("div",{className:"w-32 h-32 border-4 border-green-100 rounded-full animate-pulse opacity-30"})}),(0,s.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,s.jsx)("div",{className:"h-full w-full bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px]"})}),(0,s.jsx)("div",{className:"absolute top-0 left-0 w-1/3 h-full animate-line",children:(0,s.jsx)("div",{className:"w-px h-full bg-gradient-to-b from-transparent via-green-100 to-transparent"})})]})}var a=n(2115),i=n(2596),l=n(9688);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,l.QP)((0,i.$)(t))}let c=a.forwardRef((e,t)=>{let{className:n,type:r,...a}=e;return(0,s.jsx)("input",{type:r,className:o("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...a})});c.displayName="Input";var d=n(4624);let u=(0,n(2085).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function m(e){let{className:t,variant:n,size:r,asChild:a=!1,...i}=e,l=a?d.DX:"button";return(0,s.jsx)(l,{"data-slot":"button",className:o(u({variant:n,size:r,className:t})),...i})}var x=n(6474),h=n(4416),g=n(5736);let f=(0,n(4982).UU)("https://wkafplnaexyyuobfufxa.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndrYWZwbG5hZXh5eXVvYmZ1ZnhhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0NjYwODEsImV4cCI6MjA2MTA0MjA4MX0.Sp9g2aWN24QoymYPoYJbxInnFNMautc26uJ1ba6Dvdc");var p=n(7859),b=n(760),y=n(9300),v=n.n(y);let j=e=>{let{children:t,className:n}=e,r=(0,a.useRef)(null),[i,l]=(0,a.useState)("auto");return(0,a.useEffect)(()=>{if(r.current){let e=new ResizeObserver(e=>{l(e[0].contentRect.height)});return e.observe(r.current),()=>{e.disconnect()}}},[]),(0,s.jsx)(p.P.div,{className:v()(n,"overflow-hidden"),style:{height:i},animate:{height:i},transition:{duration:.14},children:(0,s.jsx)("div",{ref:r,children:t})})},w=()=>{let[e,t]=(0,a.useState)(!1);return(0,s.jsxs)("div",{className:"w-[350px] max-w-full mx-auto mb-2 my-4 bg-blue-50 border border-blue-200 rounded-lg shadow-sm transition-all duration-300",children:[(0,s.jsxs)("button",{onClick:()=>t(!e),className:"w-full flex justify-between items-center p-4 text-left font-semibold text-blue-800 hover:bg-blue-100 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400 rounded-lg","aria-expanded":e,"aria-controls":"updatesbox-content",children:[(0,s.jsx)("span",{children:"P2P Chat Development Updates"}),(0,s.jsx)(x.A,{size:20,className:"transform transition-transform duration-300 ".concat(e?"rotate-180":"")})]}),e&&(0,s.jsxs)(p.P.div,{id:"updatesbox-content",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},className:"p-4 border-t border-blue-200 text-sm text-blue-900 overflow-hidden",children:[(0,s.jsx)("p",{className:"font-semibold",children:"First, a huge thank you to everyone who has been using the app and participating in our initial testing phase. Your feedback has been invaluable as we work to build the best chat experience possible."}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{className:"mb-3",children:"During this test, we used a Peer-to-Peer (P2P) system, where users' devices connected directly to each other. We learned that this approach wasn't as effective as we'd hoped, as many devices, browsers, and network types couldn't form stable connections."}),(0,s.jsx)("p",{children:"Our top priority is a seamless experience for every user. That's why we're moving to a new and improved system with a powerful network of dedicated chat servers to act as a robust middleman. (While still being cost-effective!)"}),(0,s.jsx)("p",{children:"This move is a significant step forward in our mission to provide a stable, fast, and scalable platform for all of our users. We're confident this new architecture will lead to a dramatically better chat experience."}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{children:"happy chatting :D -ts"})]})]})},N=e=>{let{text:t,onRemove:n}=e;return(0,s.jsxs)("div",{className:"tag inline-flex items-center bg-green-600 text-white py-1 px-3 rounded-full m-1 font-medium text-sm transition-all duration-200",children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("button",{onClick:()=>n(t),className:"ml-2 bg-black/10 hover:bg-black/30 rounded-full w-5 h-5 flex items-center justify-center transition-colors","aria-label":"Remove ".concat(t),children:(0,s.jsx)(h.A,{size:14})})]})},k=()=>(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),C=e=>{let{isOpen:t,onClose:n,onSubmit:r}=e,[i,l]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),y=(0,a.useRef)(null);if((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),(0,a.useEffect)(()=>{if(t){var e;null==(e=y.current)||e.focus(),l(""),c(!1),u(null),f(!1)}},[t]),!t)return null;let v=async e=>{if(e.preventDefault(),!i.trim())return void u("Feedback cannot be empty.");c(!0),u(null);try{await r(i),f(!0),setTimeout(()=>{n()},2e3)}catch(e){u("Failed to submit feedback. Please try again."),console.error(e)}finally{c(!1)}};return(0,s.jsx)(b.N,{children:t&&(0,s.jsx)(p.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center","aria-modal":"true",role:"dialog",children:(0,s.jsxs)(p.P.div,{ref:y,tabIndex:-1,initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},transition:{duration:.2,ease:"easeOut"},className:"bg-white rounded-2xl shadow-2xl w-full max-w-md m-4 p-8 relative",children:[(0,s.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close dialog",children:(0,s.jsx)(h.A,{size:24})}),(0,s.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,s.jsx)("div",{className:"bg-green-100 p-3 rounded-full mb-4",children:(0,s.jsx)(g.A,{className:"text-green-600",size:32})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Got a suggestion?"}),(0,s.jsx)("p",{className:"text-gray-500 mb-6",children:"We'd love to hear your ideas for new features or improvements."})]}),x?(0,s.jsx)("div",{className:"text-center p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,s.jsx)("p",{className:"font-semibold text-green-700",children:"Thank you! Your feedback has been submitted."})}):(0,s.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"feedback-content",className:"sr-only",children:"Your suggestion"}),(0,s.jsx)("textarea",{id:"feedback-content",value:i,onChange:e=>l(e.target.value),placeholder:"Type your suggestion here...",className:"w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",required:!0})]}),d&&(0,s.jsx)("p",{className:"text-red-600 text-sm text-center",children:d}),(0,s.jsxs)(m,{type:"submit",disabled:o,className:"w-full rounded-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold text-base disabled:bg-gray-400 disabled:cursor-wait flex items-center justify-center",children:[o&&(0,s.jsx)(k,{}),o?"Submitting...":"Submit Feedback"]})]})]})})})};function S(e){let{interests:t,onInterestsChange:n,onFindMatch:r,isConnecting:i,status:l}=e,[o,d]=(0,a.useState)(""),[u,x]=(0,a.useState)([]),[h,y]=(0,a.useState)(!0),[v,S]=(0,a.useState)(null),[E,I]=(0,a.useState)(!1),_={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};(0,a.useEffect)(()=>{(async()=>{y(!0);try{let e=await fetch("".concat("https://animochat-turn-server.onrender.com","/interests/popular"));if(!e.ok)throw Error("HTTP error! Status: ".concat(e.status));let t=await e.json();x(t)}catch(e){console.error("Failed to fetch popular interests:",e),S("Could not load topics.")}finally{y(!1)}})()},[]);let T=e=>{let s=e.trim().toUpperCase();s&&!t.has(s)&&n(new Set(t).add(s)),d("")},P=e=>{let s=new Set(t);s.delete(e),n(s)},M=async e=>{let{error:t}=await f.from("suggestions").insert([{content:e}]);if(t)throw console.error("Error submitting feedback to Supabase:",t),t};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"w-[350px] max-w-full mx-auto",children:[(0,s.jsx)(j,{children:(0,s.jsx)("div",{className:"flex flex-wrap justify-center gap-2 pb-4",children:(0,s.jsx)(b.N,{children:Array.from(t).map(e=>(0,s.jsx)(p.P.div,{layout:!0,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5,transition:{duration:.12}},transition:{type:"spring",stiffness:500,damping:30},children:(0,s.jsx)(N,{text:e,onRemove:P})},e))})})}),(0,s.jsx)(c,{id:"interest-input",type:"text",value:o,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),T(o))},className:"rounded-full py-6 px-6 focus-visible:border-green-500 focus-visible:ring-green-500 ring-offset-1 text-center",placeholder:"Type an interest & press Enter",maxLength:26})]}),(0,s.jsxs)("div",{className:"mt-8 text-center",children:[(0,s.jsx)("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider mb-4",children:"Popular Topics"}),(0,s.jsx)(j,{children:(0,s.jsx)(p.P.div,{className:"flex flex-wrap justify-center gap-2 max-w-md mx-auto",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{delay:.3,staggerChildren:.07,delayChildren:.2}}},initial:"hidden",animate:"visible",children:h?(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Loading topics..."}):v?(0,s.jsx)("p",{className:"text-sm text-red-500",children:v}):0===u.length?(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"No active topics."}):u.map(e=>{let{interest:t,count:n}=e;return(0,s.jsxs)(p.P.button,{variants:_,onClick:()=>T(t),className:"bg-green-100 text-green-800 text-xs font-semibold px-3 py-1.5 rounded-full hover:bg-green-200 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.95},children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("span",{className:"bg-green-200 text-green-900 text-[10px] font-bold px-1.5 py-0.5 rounded-full ml-2",children:n})]},t)})})})]}),(0,s.jsx)("div",{className:"mt-12 w-[350px] max-w-full mx-auto",children:(0,s.jsx)(m,{onClick:()=>{let e=new Set(t);o.trim()&&!e.has(o.trim().toUpperCase())&&n(e=new Set(e).add(o.trim().toUpperCase())),r(e)},disabled:i||0===t.size&&!o.trim(),className:"w-full rounded-full py-6 bg-green-600 hover:bg-green-700 text-white font-bold text-base disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center",children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k,{}),l]}):"Find Match"})}),(0,s.jsx)(w,{}),(0,s.jsx)("div",{className:"text-center mt-6",children:(0,s.jsxs)(m,{variant:"secondary",className:"text-gray-500 hover:text-green-600 transition-colors",onClick:()=>I(!0),children:[(0,s.jsx)(g.A,{size:16,className:"mr-2"}),"We'd love to hear your feedback"]})}),(0,s.jsx)(C,{isOpen:E,onClose:()=>I(!1),onSubmit:M})]})}let E={id:"default",name:"Default Chat Theme",accentColor:"#16a34a",userBubbleGradient:"linear-gradient(90deg, #16a34a, #16a34a)",userTextColor:"#ffffff",otherBubbleGradient:"linear-gradient(90deg, #f3f4f6, #f3f4f6)",otherTextColor:"#1F2937",otherAnimated:!1,userAnimated:!1,chatBackground:"linear-gradient(180deg, #ffffff, #ffffff)"};var I=n(3319);function _(e){if(e.includes("linear-gradient")){let t=e.match(/#([0-9A-F]{6}|[0-9A-F]{3})/gi);if(t)return t.reduce((e,t)=>{let n="#"===t.charAt(0)?t.substring(1,7):t,s=parseInt(n.substring(0,2),16);return e+.299*s+.587*parseInt(n.substring(2,4),16)+.114*parseInt(n.substring(4,6),16)},0)/t.length>186?"#000000":"#ffffff"}let t="#"===e.charAt(0)?e.substring(1,7):e,n=parseInt(t.substring(0,2),16);return .299*n+.587*parseInt(t.substring(2,4),16)+.114*parseInt(t.substring(4,6),16)>186?"#000000":"#ffffff"}n(9732),n(3287);var T=n(892),P=n(8619),M=n(8829),R=n(9424);function D(e){let{visible:t,isUserMessage:n,reply:r,onOpenEmojiMenu:a,theme:i,isDeleted:l=!1}=e;return(0,s.jsxs)("div",{className:"flex flex-row h-full min-h-full justify-center space-x-1 ".concat(t?"visible":"invisible"),children:[(0,s.jsx)("div",{className:"".concat(n?"mr-1 mt-1":"ml-2 mt-1"," h-[2rem] rounded-full transition-colors p-2 cursor-pointer hover:opacity-100 opacity-80"),style:{background:n?i.userBubbleGradient:i.otherBubbleGradient,color:n?i.userTextColor:i.otherTextColor},onClick:r,children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",strokeWidth:"2",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),!l&&(0,s.jsx)("div",{className:"mt-1 h-[2rem] opacity-80 rounded-full transition-colors p-2 cursor-pointer hover:opacity-100",onClick:a,style:{background:n?i.userBubbleGradient:i.otherBubbleGradient},children:(0,s.jsx)(R.A,{className:"w-4 h-4",style:{color:n?i.userTextColor:i.otherTextColor},fill:"none",strokeWidth:"2",stroke:"currentColor",viewBox:"0 0 24 24"})}),n&&(0,s.jsx)("div",{className:"w-1"})]},"actions")}var A=n(6766);function z(e){let{message:t,isUserMessage:n,theme:r}=e;return t?"image"===t.type?(0,s.jsx)(L,{message:t,isUserMessage:n,theme:r}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"rounded-tl-3xl rounded-tr-3xl rounded-b-3xl px-3 pt-2 text-sm opacity-[0.65] pb-[32px] -mb-[32px] -z-20",style:{background:n?r.userBubbleGradient:r.otherBubbleGradient,color:n?r.userTextColor:r.otherTextColor},children:(0,s.jsx)("p",{className:"break-words whitespace-pre-wrap",children:"deleted"===t.type?"Deleted message.":t.content})})}):null}function L(e){let{message:t,isUserMessage:n,theme:r}=e;return(0,s.jsx)("div",{className:"pb-[32px] -mb-[32px] rounded-tl-3xl rounded-tr-3xl rounded-b-3xl",children:(0,s.jsx)(A.default,{src:t.content,alt:"image",className:"rounded-tl-3xl rounded-tr-3xl rounded-b-3xl object-contain mb-1",width:80,height:100})})}function F(e){let{message:t,user:n,theme:r}=e,a=t.reactions;if(!a||0===a.length)return null;let i=a.length,l=Array.from(new Set(a.map(e=>e.emoji))),o=a.find(e=>e.user_id===n.id);return(0,s.jsx)(p.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{duration:.2,ease:"easeOut"},className:"flex justify-end",children:(0,s.jsx)("div",{className:"self-end text-xs text-black relative rounded-full mt-auto bg-gray-200 border-2 border-white p-1.5 -top-2",children:(0,s.jsxs)("div",{className:"flex justify-center",children:[l.map((e,t)=>(0,s.jsx)("div",{className:"text-center",children:e},t)),(0,s.jsx)("p",{className:"pl-1",children:(0,s.jsx)("span",{style:{color:o?r.accentColor:"black"},children:i})})]})})})}var O=n(4032),W=n(9597);function B(e){var t,n,r;let{message:i,user:l,hovered:c,reply:d,animate:u=!1,onOpenEmojiMenu:m,onResendMessage:x,theme:h=E,advertisementMessageId:g,onLinkClick:f,onReact:b}=e,y=i.sender===l.id,v=(n=i.hasPrevious,r=i.hasNext,y?"rounded-tl-3xl rounded-bl-3xl ".concat(n?"rounded-tr-sm":"rounded-tr-3xl"," ").concat(r?"rounded-br-sm":"rounded-br-3xl"):"rounded-tr-3xl rounded-br-3xl ".concat(n?"rounded-tl-sm":"rounded-tl-3xl"," ").concat(r?"rounded-bl-sm":"rounded-bl-3xl")),j="sending"===i.status,w="error"===i.status,N=null!=(t=i.edited)&&t,k=i.content,C=function(e){let t=e.trim();if(!t)return!1;let n=t.replace(/\s+/g,""),s=RegExp("(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)","gu"),r=n.match(s);return!!r&&r.join("")===n}(k)&&3>=function(e){let t=e.trim().replace(/\s+/g,""),n=RegExp("(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)","gu"),s=t.match(n);return s?s.length:0}(k),S=(0,P.d)(0),I=(0,M.G)(S,y?[0,-30,-40,-50]:[0,30,40,50],[0,.5,.8,1]),T=function(e){let{delay:t=500}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,a.useRef)(null),s=(0,a.useRef)(!1),r=(0,a.useCallback)(()=>{null!==n.current&&(clearTimeout(n.current),n.current=null)},[]),i=(0,a.useCallback)(r=>{s.current=!1,n.current=window.setTimeout(()=>{e(r)},t)},[e,t]),l=(0,a.useCallback)(e=>{s.current=!0,r()},[r]);return{onTouchStart:i,onTouchMove:l,onTouchEnd:(0,a.useCallback)(e=>{s.current||e.stopPropagation(),r()},[r]),onTouchCancel:(0,a.useCallback)(e=>{r()},[r])}}(e=>{if("deleted"===i.type)return;m();let t=new TouchEvent("pointerup",{bubbles:!0,cancelable:!0,composed:!0});e.target.dispatchEvent(t)});return(0,s.jsxs)("div",{className:"relative flex w-full items-center ".concat(y?"justify-end":"justify-start"),children:[(0,s.jsx)(p.P.div,{className:o("absolute p-2.5 rounded-full",y?"right-0":"left-0"),style:{background:"".concat(h.accentColor,"15"),scale:I},children:(0,s.jsx)(O.A,{className:o("w-4 h-4"),style:{color:h.accentColor}})}),!w&&y&&(0,s.jsx)("p",{className:"opacity-50 text-[0.70rem] self-end pr-2 pb-2 overflow-clip -mr-[80px] ".concat(g!==i.id||c?"invisible":"visible"),style:{color:_(h.chatBackground)},children:"AnimoChat.com"}),y&&(0,s.jsx)(D,{isUserMessage:i.sender===l.id,visible:c,theme:h,reply:d,onOpenEmojiMenu:m,isDeleted:"deleted"===i.type}),w&&y&&(0,s.jsxs)("p",{className:"opacity-50 text-[0.70rem] self-end pr-2 pb-2 overflow-clip text-red-800",children:["Error sending message."," ",(0,s.jsx)("span",{className:"underline cursor-pointer",onClick:()=>x(i),children:"Retry"})]}),(0,s.jsxs)(p.P.div,{id:"message-bubble",dragSnapToOrigin:!0,dragTransition:{bounceDamping:13},drag:"x",dragConstraints:{left:0,right:0},onDrag:(e,t)=>{if((!y||!(t.offset.x>0))&&(y||!(t.offset.x<0))){if(document.querySelector("#emoji-overlay-main")){if(S.set(0),e instanceof TouchEvent){var n;let t=new TouchEvent("touchstart",{bubbles:!0,cancelable:!0,composed:!0,touches:[e.touches[0]]});null==(n=document)||n.dispatchEvent(t)}return}S.set(t.offset.x)}},onDragEnd:(e,t)=>{(y&&t.offset.x<-50||!y&&t.offset.x>50)&&!document.querySelector("#emoji-overlay-main")&&d(),S.set(0)},whileTap:{scale:.8},style:{x:S,originX:+!!y,WebkitTapHighlightColor:"transparent"},onDoubleClick:()=>{b("❤️")},..."deleted"!==i.type&&{onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),m()}},...T,initial:!!u&&{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",duration:.4},className:"max-w-[75%] mb-0.5 flex flex-col ".concat(y?"items-end":"items-start"," ").concat(j?"opacity-50":""),children:[N&&(0,s.jsx)("p",{className:"text-[0.70rem] px-2 text-gray-500",children:"Edited"}),i.replyingTo&&(0,s.jsx)(z,{message:i.replyingTo,isUserMessage:y,theme:h}),(null===i.type||void 0===i.type||"text"===i.type||"deleted"===i.type)&&(0,s.jsx)(Y,{isLargeEmojiMessage:C,message:i,user:l,theme:h,isUserMessage:y,roundedCorners:v,onLinkClick:f}),"image"===i.type&&(0,s.jsx)(U,{user:l,message:i,roundedCorners:v,isUserMessage:y,theme:h})]},i.id+"-bubble"),!y&&(0,s.jsx)(D,{visible:c,theme:h,isUserMessage:!1,reply:d,onOpenEmojiMenu:m}),!y&&(0,s.jsx)("p",{className:"opacity-50 text-[0.70rem] self-end pl-2 pb-2 -ml-[70px] ".concat(g!==i.id||c?"invisible":"visible"),style:{color:_(h.chatBackground)},children:"AnimoChat.com"})]},i.id)}function U(e){let{user:t,message:n,roundedCorners:r,isUserMessage:i,theme:l}=e,[o,c]=(0,a.useState)(!1),d="rounded-3xl ".concat(r," ").concat(i?"rounded-tr-3xl":"rounded-tl-3xl");return(0,s.jsxs)("div",{id:"image-message-container",onClick:()=>c(!0),style:{cursor:"pointer"},children:[(0,s.jsxs)("div",{className:d,style:{overflow:"hidden",position:"relative",border:"2px solid transparent"},children:[(0,s.jsx)(W.A8,{src:n.content,children:(0,s.jsx)(A.default,{width:Math.min(.6*window.innerWidth,300),height:Math.min(.6*window.innerWidth,300),className:d,src:n.content,alt:"Image",style:{filter:o?"none":"blur(8px)",transition:"filter 0.3s ease-in-out",maxWidth:"100%",objectFit:"contain",backgroundColor:l.chatBackground},sizes:"(max-width: 768px) 70vw, 400px"})},n.id),!o&&(0,s.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:l.userTextColor,backgroundColor:"rgba(0, 0, 0, 0.4)",padding:"4px 8px",borderRadius:"0.25rem",pointerEvents:"none",fontSize:"0.85rem"},children:"(tap to reveal)"})]}),(0,s.jsx)(F,{message:n,user:t,theme:l})]})}function Y(e){let{message:t,user:n,theme:r,isUserMessage:a,roundedCorners:i,isLargeEmojiMessage:l,onLinkClick:o}=e,c="deleted"===t.type;return(0,s.jsx)(s.Fragment,{children:l?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"px-2 py-2",children:[(0,s.jsx)("p",{className:"text-5xl",children:t.content}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(F,{message:t,user:n,theme:r})})]})}):(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("div",{className:"".concat(i," animate-gradient-x"),style:{background:a?r.userBubbleGradient:r.otherBubbleGradient,backgroundSize:"200% 100%",color:a?r.userTextColor:r.otherTextColor}}),(0,s.jsx)("div",{className:"".concat(i," relative max-w-full break-words px-3 py-2 ").concat(!a&&r.otherAnimated||a&&r.userAnimated?"bg-white opacity-70":""),style:{wordBreak:"break-word",overflowWrap:"break-word",color:a?r.userTextColor:r.otherTextColor},children:(0,s.jsx)("p",{className:"break-words whitespace-pre-wrap",children:(0,s.jsx)(T.A,{options:{attributes:{target:"_blank",rel:"noopener noreferrer",className:"underline"},render:e=>{let{attributes:t,content:n}=e;return(0,s.jsx)("a",{...t,onClick:e=>{o?o(e):e.stopPropagation()},children:n})}},children:c?(0,s.jsx)("span",{className:"italic",children:"Message has been deleted."}):t.content})})})]}),(0,s.jsx)(F,{message:t,user:n,theme:r})]})})}function G(e){let{message:t,user:n,onSwipe:r,onReact:i,onStartedSwipe:l,onEndedSwipe:o,animate:c=!1,theme:d=E,advertisementMessageId:u,onOpenEmojiMenu:m=()=>{},onResendMessage:x=()=>{},isEmojiMenuOpen:h,onLinkClick:g}=e,[f,p]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{y("ontouchstart"in window||navigator.maxTouchPoints>0)},[]),(0,s.jsx)("div",{"data-message-id":"message-"+t.id,className:"relative px-4 select-none",onMouseEnter:()=>!b&&p(!0),onMouseLeave:()=>!b&&p(!1),children:(0,s.jsx)("div",{children:(0,s.jsx)(B,{onLinkClick:g,animate:c,message:t,user:n,hovered:f,reply:()=>r(t.id),onOpenEmojiMenu:()=>m(t),onReact:e=>i(t.id,e),onResendMessage:x,theme:d,advertisementMessageId:u},t.id+"-bubble")},"parent-message-bubble flex flex-col")})}function X(e){let{index:t,message:n,user:r,animate:a=!1,isLast:i=!1,onSwipe:l,onStartedSwipe:o,onEndedSwipe:c,onReact:d,onOpenEmojiMenu:u,onResendMessage:m,isEmojiMenuOpen:x,theme:h,secondVisibleElement:g,onLinkClick:f}=e;if("system"===n.sender)return(0,s.jsx)("div",{className:"flex justify-center py-4 px-4 text-center",children:(0,s.jsx)("p",{className:"text-xs text-gray-500",children:n.content})},n.id+"_system");let p=t%5==0?n.id:null;return(0,s.jsxs)("div",{"data-is-message":"true","data-message-id":n.id,className:"max-w-full w-full select-none",children:[n.showTime&&(0,s.jsx)("div",{className:"flex justify-center py-4",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 font-normal",children:n.created_at&&(0,I.GP)(new Date(n.created_at),"h:mm a")})},n.id+"_time"),(0,s.jsx)(G,{advertisementMessageId:p,message:n,animate:a,user:r,onSwipe:l,onStartedSwipe:o,onEndedSwipe:c,onReact:d,onOpenEmojiMenu:u,onResendMessage:m,theme:h,isEmojiMenuOpen:x,onLinkClick:f},n.id+"_message"),(i||!n.hasNext)&&(0,s.jsx)("div",{className:"h-1"},n.id+"_bottom")]},"parent_message_"+n.id)}let q=["❤️","\uD83D\uDE06","\uD83D\uDE2E","\uD83D\uDE22","\uD83D\uDE2D","\uD83D\uDE21","\uD83D\uDC4D"];function J(e){let{isUserMessage:t,preselectedEmoji:n,message:r,messageDiv:i,onReact:l,onClose:o}=e,c=(0,a.useRef)(null),[d,u]=(0,a.useState)({top:0,left:0}),[m,x]=(0,a.useState)(null),h=(0,a.useRef)(null);return(0,a.useLayoutEffect)(()=>{let e=i.querySelector("#message-bubble");if(e.style.position="relative",e.style.zIndex="30",e&&c.current){let t=e.getBoundingClientRect(),n=c.current,s=n.offsetHeight,r=t.top+window.scrollY-s-10,a=t.right-n.offsetWidth-16;e.classList.contains("items-end")||(a=t.left-16),u({top:r,left:a})}return()=>{e.style.zIndex="0"}},[i]),(0,a.useEffect)(()=>{let e=c.current;if(!e)return;let t=t=>{if(0!==t.button)return;try{e.setPointerCapture(t.pointerId)}catch(e){}h.current=t.pointerId;let n=document.elementFromPoint(t.clientX,t.clientY);if(n){let e=n.closest("[data-emoji]");if(e)return void x(e.getAttribute("data-emoji"))}x(null)},s=t=>{if(h.current!==t.pointerId||!e)return;let n=document.elementFromPoint(t.clientX,t.clientY);if(n){let e=n.closest("[data-emoji]");if(e)return void x(e.getAttribute("data-emoji"))}x(null)},a=t=>{if(h.current===t.pointerId){if(m){let e=(null==n?void 0:n.emoji)===m?null:m;l(r.id,e)}o();try{e.releasePointerCapture(t.pointerId)}catch(e){}h.current=null}};return e.addEventListener("pointerdown",t),window.addEventListener("pointermove",s),window.addEventListener("pointerup",a),()=>{e.removeEventListener("pointerdown",t),window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",a)}},[m,l,o,n,r.id]),(0,s.jsx)(p.P.div,{layout:!0,className:"absolute top-0 left-0 w-screen h-screen",initial:{userSelect:"none",zIndex:100,opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,s.jsx)("div",{id:"emoji-abs-container",className:"absolute border-box flex z-50 w-full md:w-fit px-4",style:{position:"absolute",top:d.top,left:d.left},children:(0,s.jsx)(p.P.div,{ref:c,id:"emoji-container-wrapper",className:"w-full backdrop-blur-md bg-gray-100 py-2 px-5 dark:bg-gray-800/80 shadow-lg rounded-full border border-gray-200 dark:border-gray-700",initial:{scale:.8,opacity:0,y:10},animate:{scale:1,opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:20}},exit:{scale:.8,opacity:0,y:10,transition:{duration:.15}},children:(0,s.jsx)("div",{id:"emoji-container",className:"flex justify-between",children:(0,s.jsx)(b.N,{children:q.map(e=>(0,s.jsxs)(p.P.div,{className:"relative z-10 cursor-pointer rounded-full p-2 ".concat((null==n?void 0:n.emoji)===e?"bg-gray-200/80 dark:bg-gray-700/80":m===e?"bg-gray-100/80 dark:bg-gray-600/80":""),"data-emoji":e,animate:{scale:m===e?1.6:1},transition:{type:"spring",stiffness:300,damping:20},children:[(0,s.jsx)("span",{className:"text-xl",children:e}),(null==n?void 0:n.emoji)===e&&(0,s.jsx)(p.P.div,{className:"absolute -bottom-0.5 left-1/2 w-1 h-1 bg-green-500 rounded-full",initial:{opacity:0},animate:{opacity:1},layoutId:"selectedDot",style:{translateX:"-50%"}})]},e))})})})})},"emoji-menu")}var H=n(4357),V=n(3717),Z=n(4126);function Q(e){let{theme:t,anchor:n,onReply:r,onCopy:i,onEdit:l,onClose:o,onDelete:c}=e,d=n.querySelector("#message-bubble"),u=d.classList.contains("items-end"),m=null!==d.querySelector("#image-message-container"),x=[{icon:(0,s.jsx)(O.A,{className:"h-4 w-4"}),text:"Reply",onClick:r},{icon:(0,s.jsx)(H.A,{className:"h-4 w-4"}),text:"Copy",onClick:i},...u&&!m?[{icon:(0,s.jsx)(V.A,{className:"h-4 w-4"}),text:"Edit",onClick:l}]:[],...u?[{icon:(0,s.jsx)(Z.A,{className:"h-4 w-4"}),text:"Delete",onClick:c}]:[]],[h,g]=(0,a.useState)({top:0,left:0}),[f,b]=(0,a.useState)(null),y=(0,a.useRef)(null),v=(0,a.createRef)();return(0,a.useEffect)(()=>{y.current=f},[f]),(0,a.useLayoutEffect)(()=>{if(!n||!v.current)return;let e=n.querySelector("#message-bubble"),t=document.querySelector("#chat-container"),s=e.getBoundingClientRect(),r=v.current.getBoundingClientRect(),a=s.bottom+10;if(a+r.height>t.clientHeight/2){a=s.top-r.height-10;let e=document.querySelector("#emoji-abs-container");e&&(e.style.top="".concat(a-r.height,"px"),a-=e.offsetHeight+24)}a+=window.scrollY;let i=s.right-r.width-24;u||(i=s.left),g({top:a,left:i})},[n,u]),(0,a.useEffect)(()=>{let e=e=>{if(!v.current)return;let t=v.current.querySelectorAll("button"),n=null;t.forEach((t,s)=>{let r=t.getBoundingClientRect();e.clientX>=r.left&&e.clientX<=r.right&&e.clientY>=r.top&&e.clientY<=r.bottom&&(n=s)}),b(n)},t=e=>{if(null!==y.current&&v.current){let e=v.current.querySelectorAll("button")[y.current];e&&e.click()}};window.addEventListener("pointermove",e),window.addEventListener("pointerup",t);let n=new PointerEvent("pointerdown",{bubbles:!0});return window.dispatchEvent(n),()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",t)}},[]),(0,s.jsx)(p.P.div,{ref:v,id:"context-menu",className:"absolute flex flex-col rounded-3xl w-[200px] overflow-clip",style:{background:(null==t?void 0:t.chatBackground)||"linear-gradient(180deg, #ffffff, #ffffff)",top:h.top,left:h.left},initial:{opacity:0,scale:.9,transition:{type:"spring",stiffness:300,damping:20}},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9,transition:{duration:.15}},children:x.map((e,t)=>(0,s.jsx)(K,{icon:e.icon,text:e.text,onClick:()=>{e.onClick(),o()},active:f===t},t))})}function K(e){let{icon:t,text:n,onClick:r,active:a}=e;return(0,s.jsx)("div",{children:(0,s.jsxs)("button",{onClick:r,className:"flex items-center justify-start w-full px-6 py-4 text-sm text-black hover:bg-gray-200 ".concat(a?"bg-gray-200":""),children:[(0,s.jsx)("p",{className:"mr-auto",children:n}),t]})})}let $=e=>{var t,n,r,a;let{open:i,message:l,messageDiv:o,user:c,onReact:d,onClose:u,onCopy:m,onEdit:x,onReply:h,onDelete:g}=e;return(0,s.jsx)(b.N,{children:i&&(0,s.jsxs)("div",{id:"emoji-overlay-main",className:"overflow-visible absolute left-0 top-0 select-none",children:[(0,s.jsx)(p.P.div,{layout:!0,initial:{opacity:0},animate:{opacity:.5},exit:{opacity:0},className:"fixed inset-0 bg-black z-30",onClick:u},"emoji-overlay"),(0,s.jsxs)("div",{className:"relative z-40 w-full",children:[(0,s.jsx)(J,{isUserMessage:l.sender===c.id,preselectedEmoji:(null==(n=l.reactions)||null==(t=n.find(e=>e.user_id===c.id))?void 0:t.emoji)!=null?{emoji:null==(a=l.reactions)||null==(r=a.find(e=>e.user_id===c.id))?void 0:r.emoji}:void 0,messageDiv:o,message:l,onReact:d,onClose:u},"emoji-menu"),(0,s.jsx)(Q,{onCopy:()=>m(l.id),onEdit:()=>x(l.id),onReply:()=>h(l.id),onDelete:()=>g(l.id),onClose:u,theme:E,anchor:o},"context-menu")]},"context-container")]},"emoji-overlay-main")})};var ee=n(4304);let et=()=>(0,s.jsx)(p.P.div,{className:"flex justify-start",children:(0,s.jsxs)("div",{className:"flex mb-2 mx-4 max-w-[100%] rounded-3xl px-4 py-4 bg-gray-100 text-gray-800 relative",children:[(0,s.jsx)("div",{className:"h-2 w-2 bg-gray-800 rounded-full animate-bounce [animation-delay:-0.3s]"}),(0,s.jsx)("div",{className:"h-2 w-2 mx-1 bg-gray-800 rounded-full animate-bounce [animation-delay:-0.15s]"}),(0,s.jsx)("div",{className:"h-2 w-2 bg-gray-800 rounded-full animate-bounce"})]})},"typing-motiondiv"),en=(e,t)=>Math.random()*(t-e)+e,es=e=>{let{a:t,d:n}=e,r=Math.cos(t)*n,a=Math.sin(t)*n,i=en(2,4),l=en(0,2),o=en(.8,1.2);return(0,s.jsx)(p.P.div,{className:"absolute bg-white rounded-full",style:{width:10,height:10,left:"50%",top:"50%",translateX:"-50%",translateY:"-50%"},initial:{x:0,y:0,scale:0},animate:{x:r,y:a,scale:o},transition:{duration:i,delay:l,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}})},er=()=>{let e=Array.from({length:5}).map((e,t)=>({id:t,angle:t/5*2*Math.PI,distance:en(80,120)})),t={initial:{scale:0,opacity:1},animate:e=>({scale:1,opacity:0,transition:{delay:.7*e,duration:2.1,repeat:1/0,ease:"circOut"}})};return(0,s.jsxs)(p.P.div,{className:"absolute inset-0 flex flex-col items-center justify-center w-full h-full bg-green-500 overflow-hidden z-10",variants:{hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1,transition:{duration:.4,ease:"easeOut"}},exit:{opacity:0,scale:.95,transition:{duration:.3,ease:"easeIn"}}},initial:"hidden",animate:"visible",exit:"exit",children:[(0,s.jsxs)("div",{className:"relative w-64 h-64 flex items-center justify-center",children:[(0,s.jsx)(b.N,{children:[0,1,2].map(e=>(0,s.jsx)(p.P.div,{className:"absolute w-full h-full rounded-full border-2 border-white/50",variants:t,initial:"initial",animate:"animate",custom:e},e))}),(0,s.jsx)(p.P.div,{className:"relative w-24 h-24 bg-white rounded-full flex items-center justify-center shadow-lg",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:(0,s.jsx)("svg",{className:"w-12 h-12 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8s-9-3.582-9-8 4.03-8 9-8 9 3.582 9 8z"})})}),(0,s.jsx)("div",{className:"absolute w-full h-full",children:e.map(e=>(0,s.jsx)(es,{a:e.angle,d:e.distance},e.id))})]}),(0,s.jsx)(p.P.p,{className:"mt-8 text-2xl font-semibold text-white tracking-wider",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5,ease:"easeOut"},children:"Finding a match..."})]})};function ea(e){let{messages:t,goBack:n,sendMessage:r,onStartTyping:i,onEditMessage:l,isStrangerTyping:o,endChat:d,newChat:u,onReact:x,peerId:h,status:g}=e,y={id:h},[v,w]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=async()=>{let{data:e,error:t}=await f.from("announcements").select("*").order("created_at",{ascending:!1}).limit(1).single();if(t)return void console.error("Error fetching announcement:",t);e&&e.content&&e&&w(e.content)},t=f.channel("public:announcements");return t.on("postgres_changes",{event:"INSERT",schema:"public",table:"announcements"},e=>{console.log("New announcement:",e),e.new.content&&w(e.new.content)}),t.on("postgres_changes",{event:"UPDATE",schema:"public",table:"announcements"},e=>{console.log("Updated announcement:",e),e.new.content&&w(e.new.content)}),e(),t.subscribe(),()=>{f.removeChannel(t)}},[]);let N=function(e){let[t,n]=(0,a.useState)([]);return(0,a.useEffect)(()=>{if(!e||0===e.length)return void n([]);let t=null,s=[];for(let n=0;n<e.length;n++){let r=e[n],a=new Date(r.created_at).getTime(),i=!1;isNaN(a)?console.warn("Invalid date encountered for message:",r.id):"system"!==r.sender&&"typing"!==r.id&&"filler"!==r.id&&(null===t||a-t>3e5)&&(i=!0,t=a),s.push({...r,showTime:i,hasPrevious:!1,hasNext:!1})}s=s.map(e=>{let t=e.replyingTo;if(t&&"string"==typeof t){let n=s.find(e=>e.id===t);if(n)return{...e,replyingTo:n}}return e});for(let e=0;e<s.length;e++){let t=s[e],n=s[e-1],r=s[e+1];if(!t)continue;t.hasPrevious=!!n&&n.sender===t.sender,t.hasNext=!!r&&r.sender===t.sender,t.showTime&&n&&(t.hasPrevious=!1,n.hasNext=!1),t.reactions&&t.reactions.length>0&&r&&(t.hasNext=!1,r.sender===t.sender&&(r.hasPrevious=!1)),t.replyingTo&&n&&(t.hasPrevious=!1,n.sender===t.sender&&(n.hasNext=!1)),t.replyingTo&&r&&(t.hasNext=!1,r.sender===t.sender&&(r.hasPrevious=!1)),n&&n.replyingTo&&(t.hasPrevious=!1,n.hasNext=!1);let a=s[e+1];a&&("system"===a.sender||"typing"===a.id||"filler"===a.id)&&(t.hasNext=!1)}let r=null,a=s.findIndex(e=>"typing"===e.id);-1!==a&&(r=s.splice(a,1)[0]);let i=new Set,l=s.filter(e=>!i.has(e.id)&&(i.add(e.id),!0));r&&l.push(r),n(l)},[e]),t}(t),k=(0,a.useRef)(null),[C,S]=(0,a.useState)(!1),I=(0,a.useRef)(N.length),[_,T]=(0,a.useState)(!1),P=(0,a.useRef)(new Set);(0,a.useRef)({startIndex:0,endIndex:0});let[M,R]=(0,a.useState)(!1),D=(0,a.useRef)(!0),[A,z]=(0,a.useState)(""),[L,F]=(0,a.useState)(!1);(0,a.useRef)(null);let O=(0,a.useRef)(!1),[W,B]=(0,a.useState)({open:!1}),U=(0,a.useRef)(!1),[Y,G]=(0,a.useState)(null),q=e=>{if(!e){B({open:!1}),U.current=!1;return}let t=document.querySelector('[data-message-id="'.concat(null==e?void 0:e.id,'"]'));t&&(U.current=!0,B({open:!0,message:e,messageDiv:t}))};(0,a.useEffect)(()=>{P.current=new Set(N.map(e=>e.id))},[N]),(0,a.useEffect)(()=>{if(0===N.length)return;let e=N.length>I.current,t=N[N.length-1];if("typing"===t.id){I.current=N.length;return}if(e)if(t.sender===y.id||D.current){var n;null==(n=k.current)||n.scrollToIndex(N.length-1,{align:"end",smooth:!0})}else T(!0);I.current=N.length},[N,y.id,k]),(0,a.useEffect)(()=>{if(D.current&&o){var e;null==(e=k.current)||e.scrollToIndex(N.length)}},[o,k,N]),(0,a.useEffect)(()=>{let e=document.querySelector("#chat-messages-list");if(!e)return;let t=C||W.open;e.style.overflow=t?"hidden":"auto"},[C,W]);let J=(e,n)=>"system"===e.sender||"system"===e.type?(0,s.jsx)("div",{className:"text-center my-2 mx-4",children:(0,s.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 rounded-full px-3 py-1",children:e.content})},n):(0,s.jsx)(j,{children:(0,s.jsx)(X,{index:n,message:e,user:{id:h},isLast:0===n,onSwipe:e=>{let n=t.find(t=>t.id===e);n&&G({message:n,type:"replying",title:"Replying",description:n.content})},onStartedSwipe:()=>{},onEndedSwipe:()=>{},onReact:x,onOpenEmojiMenu:()=>q(e),onResendMessage:()=>{},isEmojiMenuOpen:O,theme:E,animate:!0,secondVisibleElement:null},n)},e.id+"listener");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)($,{open:W.open,message:W.message,messageDiv:W.messageDiv,user:y,onReact:x,onReply:e=>{let n=t.find(t=>t.id===e);n&&G({message:n,type:"replying",title:"Replying",description:n.content})},onEdit:e=>{let n=t.find(t=>t.id===e);n&&(z(n.content),G({message:n,type:"editing",title:"Editing",description:n.content}))},onCopy:e=>{let n=t.find(t=>t.id===e);n&&(navigator.clipboard.writeText(n.content).then(()=>{console.log("Message copied to clipboard")}).catch(e=>{console.error("Failed to copy message: ",e)}),q(null))},onDelete:e=>{t.find(t=>t.id===e)&&(console.log("Delete message with ID: ".concat(e)),q(null))},onClose:()=>q(null)}),(0,s.jsxs)("div",{id:"chat-container",className:"w-full max-w-md mx-auto h-[100dvh] flex flex-col bg-white/70 backdrop-blur-xl sm:rounded-[2rem] shadow-2xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 bg-white/60 border-b border-gray-200/80 flex items-center shrink-0",children:["connected"!==g&&(0,s.jsx)(m,{variant:"outline",size:"sm",onClick:n,className:"rounded-full mr-2",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,s.jsxs)("div",{className:"text-left mr-auto ml-2",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-gray-500",children:"Status"}),(0,s.jsx)("p",{className:"text-sm font-semibold text-green-600",children:g.charAt(0).toUpperCase()+g.slice(1)})]}),"connected"===g&&(0,s.jsx)(m,{variant:L?"destructive":"outline",size:"sm",onClick:()=>{L?(d(),F(!1)):F(!0)},className:"rounded-full",children:L?"Confirm?":"End Chat"}),"connected"!==g&&(0,s.jsx)(m,{variant:"default",size:"sm",onClick:u,className:"bg-green-600 rounded-full hover:bg-green-700",children:"New Chat"})]}),v&&(0,s.jsx)("div",{className:"p-2 text-center text-xs text-gray-500 bg-white/60 border-b border-gray-200/80 shrink-0",children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:v}})}),(0,s.jsxs)("div",{className:"max-h-full h-full scrollbar-thin scrollbar-thumb-green-600 scrollbar-track-gray-100 hover:scrollbar-thumb-green-700",children:[(0,s.jsxs)(ee.x8,{ref:k,style:{overflowX:"hidden"},id:"chat-messages-list",onScroll:e=>{k.current&&(R(!0),D.current=e-k.current.scrollSize+k.current.viewportSize>=-100,D.current&&T(!1))},onScrollEnd:()=>{R(!1)},reverse:!0,children:[N.map((e,t)=>J(e,t)),(0,s.jsx)(j,{children:o&&(0,s.jsx)(et,{},"typing-indicator")})]}),(0,s.jsx)(b.N,{children:("waiting_for_match"===g||"finding_match"===g||"connecting"===g)&&(0,s.jsx)(er,{})}),(0,s.jsx)(b.N,{children:_&&(0,s.jsx)(p.P.div,{className:"absolute bottom-0 left-0 w-full flex items-center justify-center pb-24 pt-4",initial:{y:"100%"},animate:{y:"0"},exit:{y:"100%"},children:(0,s.jsxs)("button",{onClick:()=>{var e;null==(e=k.current)||e.scrollToIndex(N.length-1,{align:"end",smooth:!0}),T(!1)},className:"bg-green-600 text-white px-4 py-2 rounded-full shadow-md flex items-center gap-2 hover:bg-green-700 transition-colors",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),"New messages"]})})})]}),Y&&(0,s.jsx)("div",{className:"flex items-start gap-2 px-3 py-2 bg-gray-100 border-l-4 mb-2 relative",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs font-semibold text-green-700",children:"replying"===Y.type?"Replying to":"Editing"}),(0,s.jsx)("button",{type:"button",className:"ml-auto text-gray-400 hover:text-gray-600","aria-label":"Cancel",onClick:()=>G(null),children:(0,s.jsxs)("svg",{width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,s.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,s.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,s.jsx)("div",{className:"text-xs text-gray-700 truncate max-w-xs",children:Y.description})]})}),(0,s.jsx)("div",{className:"p-4 bg-white/60 border-t border-gray-200/80 shrink-0",children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=A.trim();if(t){var n;let e=null==Y||null==(n=Y.message)?void 0:n.id;if(e&&(null==Y?void 0:Y.type)==="editing"){null==l||l(e,t),G(null),z("");return}r(t,e),z(""),e&&G(null)}},className:"flex space-x-3",children:[(0,s.jsx)(c,{disabled:"connected"!==g,type:"text",value:A,onChange:e=>{z(e.target.value),i()},placeholder:"Type a message...",className:"text-[16px] flex-grow p-3 border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-600 bg-white/80",autoComplete:"off",required:!0}),(0,s.jsx)(m,{type:"submit",disabled:!A.trim()||"connected"!==g,className:"bg-green-600 text-white font-bold w-12 h-12 rounded-full hover:bg-green-700 flex items-center justify-center shadow-lg",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),(0,s.jsx)("polyline",{points:"5 12 12 5 19 12"})]})})]})})]})]})}var ei=n(1368);let el="https://animochat-turn-server.onrender.com",eo=()=>{let[e,t]=(0,a.useState)("intro"),[n,s]=(0,a.useState)("initializing"),[r,i]=(0,a.useState)([]),[l,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1),x=(0,a.useRef)(null),h=(0,a.useRef)(null),g=(0,a.useRef)(!1);(0,a.useEffect)(()=>{let e=localStorage.getItem("animochat_user_id");if(e)o(e);else{let e=(0,ei.A)();localStorage.setItem("animochat_user_id",e),o(e)}return(async()=>{let n="".concat(el,"/session/").concat(e);try{let r=await fetch(n);if(!r.ok)return void s("ready");let a=await r.json(),{chatId:i,serverUrl:l,participants:o}=a;if(!i||!l){console.log("No existing session found."),s("ready");return}console.log("Found existing session:",a),d(a.chatId);let c="".concat(l,"?userId=").concat(e,"&chatId=").concat(a.chatId);console.log("Connecting to WebSocket server: ".concat(c));let u=new WebSocket(c);x.current=u,k(u,a.chatId,[],!0),t("chat"),s("connecting"),console.log("Reconnected to chat: ".concat(a.chatId))}catch(e){console.error("Error fetching existing session:",e),s("error")}})(),()=>{var e,t;console.log("Cleaning up useAnimochat hook."),null==(e=h.current)||e.close(),null==(t=x.current)||t.close()}},[]);let f=(e,t,n)=>{console.log("Handling reaction:",{messageId:e,emoji:t,userId:n}),i(s=>s.map(s=>{let r;if(s.id!==e||"system"===s.type)return s;let a=s.reactions||[],i=a.findIndex(e=>e.user_id===n);return i>-1?t?(r=[...a])[i]={user_id:n,emoji:t,message_id:e}:r=a.filter((e,t)=>t!==i):r=t?[...a,{user_id:n,emoji:t,message_id:e}]:a,{...s,reactions:r}}))},p=(0,a.useCallback)(e=>{x.current&&x.current.readyState===WebSocket.OPEN?x.current.send(JSON.stringify(e)):console.error("Cannot send packet, WebSocket connection is not open.")},[]),b=(0,a.useCallback)(()=>{g.current||(g.current=!0,p({type:"typing",content:!0,sender:l}),setTimeout(()=>{g.current=!1,p({type:"typing",content:!1,sender:l})},3e3))},[l,p]),y=(0,a.useCallback)(async(e,t)=>{l&&(f(e,t||null,l),p({type:"reaction",sender:l,content:{message_id:e,emoji:t||null,user_id:l}}))},[l,p]),v=(0,a.useCallback)((e,t)=>{t&&e&&l&&(i(n=>n.map(n=>n.id===e?{...n,content:t,edited:!0}:n)),p({type:"edit_message",content:{message_id:e,new_content:t,user_id:l},sender:l}))},[l,p]),j=(0,a.useCallback)((e,t)=>{if(!l||!c)return;p({type:"typing",content:!1,sender:l});let n={id:"msg_".concat(Date.now()),session_id:c,created_at:new Date().toISOString(),content:e,replyingTo:t,sender:l};p({type:"message",content:n,sender:l}),i(e=>[...e,n])},[l,c,p]),w=(0,a.useCallback)(()=>{var e,t;(async()=>{let e="".concat(el,"/session/disconnect?userId=").concat(l);try{let t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:l})});t.ok?console.log("Successfully disconnected from session."):console.error("Failed to disconnect from session:",t.statusText)}catch(e){console.error("Error disconnecting from session:",e)}})().then(()=>{console.log("Disconnected from matchmaking and chat.")}),x.current&&x.current.send(JSON.stringify({type:"disconnect",content:null,sender:l})),null==(e=x.current)||e.close(),x.current=null,null==(t=h.current)||t.close(),h.current=null,s("disconnected"),d("")},[l]),N=(0,a.useCallback)(e=>{if(console.log("Starting matchmaking with interests:",e),!l){console.error("User ID not set yet. Cannot start matchmaking."),s("error");return}t("chat"),s("finding_match");let n=e.join(","),r="".concat(el,"/matchmaking?userId=").concat(l,"&interest=").concat(n);console.log("Connecting to matchmaking server: ".concat(r));let a=new EventSource(r);h.current=a,a.onmessage=e=>{let t=JSON.parse(e.data);if(console.log("Matchmaking update:",t),"MATCHED"===t.state&&t.chatId){var n;console.log("Match found with user ".concat(t.matchedUserId,"! ChatID: ").concat(t.chatId)),s("connecting"),a.close(),d(t.chatId);let e=t.chatServerUrl,r="".concat(e,"?userId=").concat(l,"&chatId=").concat(t.chatId);console.log("Connecting to WebSocket server: ".concat(r));let i=new WebSocket(r);x.current=i;let o=(null==(n=t.interest)?void 0:n.split(","))||[];k(i,t.chatId,o,!1)}else"WAITING"===t.state&&(console.log("Waiting for a match..."),s("waiting_for_match"))},a.onerror=e=>{console.error("EventSource failed:",e),s("error"),a.close()}},[l]),k=(0,a.useCallback)(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.onopen=()=>{console.log("WebSocket connection established."),s("connected");let e="You matched with a stranger on ".concat(n.join(", "),"! Say hi!");r&&(e="Reconnected to chat with a stranger. Previous messages may not be visible yet."),i([{id:"system_".concat(Date.now()),session_id:t,created_at:new Date().toISOString(),type:"system",content:e,sender:"system"}])},e.onmessage=async n=>{let r,a=n.data,o=r=a instanceof Blob?JSON.parse(await a.text()):"string"==typeof a?JSON.parse(a):a;if(console.log("Received packet:",r),o.sender!==l)switch(console.log("Packet sender: ",o.sender),console.log("Current user ID: ",l),o.type){case"offline":console.log("Received offline packet from server.");let c=o.content!==l,u={id:"system_".concat(Date.now()),session_id:t,created_at:new Date().toISOString(),type:"system",content:c?"Your partner has went offline.":"You are currently offline.",sender:"system"};i(e=>[...e,u]);break;case"disconnect":var g;console.log("Received disconnect packet from server."),s("disconnected");let p={id:"system_".concat(Date.now()),session_id:t,created_at:new Date().toISOString(),type:"system",content:"The other user has disconnected.",sender:"system"};i(e=>[...e,p]),e.close(),x.current=null,null==(g=h.current)||g.close(),h.current=null,d("");break;case"STATUS":let b={id:"system_".concat(Date.now()),session_id:t,created_at:new Date().toISOString(),type:"system",content:o.message,sender:"system"};i(e=>[...e,b]);break;case"message":i(e=>[...e,o.content]);break;case"reaction":let{message_id:y,emoji:v,user_id:j}=o.content;f(y,v,j);break;case"typing":if(o.sender===l)return;m(o.content);break;case"edit_message":let{message_id:w,new_content:N,user_id:k}=o.content;i(e=>e.map(e=>e.id===w&&e.sender===k?{...e,content:N,edited:!0}:e))}},e.onclose=()=>{console.log("WebSocket connection closed."),s("disconnected");let e={id:"system_".concat(Date.now()),session_id:t,created_at:new Date().toISOString(),type:"system",content:"The connection has been closed.",sender:"system"};i(t=>[...t,e])},e.onerror=e=>{console.error("WebSocket error:",e),s("error")}},[l,c,f]);return{screen:e,status:n,messages:r,userId:l,isStrangerTyping:u,handleGetStarted:()=>t("matchmaking"),startMatchmaking:N,sendMessage:j,disconnect:w,onReact:y,editMessage:v,onStartTyping:b}};function ec(){let{screen:e,userId:t,status:n,messages:i,startMatchmaking:l,disconnect:o,editMessage:c,sendMessage:d,onReact:u,onStartTyping:x,handleGetStarted:h,isStrangerTyping:g}=eo(),[f,y]=(0,a.useState)(new Set),v=e=>{if(0===e.size)return void h();l(Array.from(e))},j={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.23,ease:"easeInOut"}};return(0,s.jsx)("div",{className:"h-full overflow-y-auto overflow-x-hidden",children:(0,s.jsxs)("main",{className:"container h-full mx-auto flex flex-col ".concat("chat"===e?"p-0":"px-4 py-8 md:py-16"),children:["chat"!==e&&(0,s.jsx)(r,{}),(0,s.jsx)("div",{className:"flex-grow flex flex-col justify-center items-center",children:(0,s.jsx)(b.N,{mode:"wait",children:(()=>{switch(e){case"chat":return(0,s.jsx)(p.P.div,{...j,className:"h-full w-full flex items-center justify-center sm:p-4",children:(0,s.jsx)(ea,{goBack:()=>{h()},onEditMessage:c,onStartTyping:x,isStrangerTyping:g,onReact:u,messages:i,sendMessage:d,newChat:()=>{v(f)},endChat:o,peerId:t,status:n})},"chat");case"matchmaking":return(0,s.jsxs)(p.P.div,{...j,className:"w-full h-full flex flex-col justify-center items-center",children:[(0,s.jsx)("div",{className:"max-w-3xl mx-auto relative w-full",children:(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsx)("h2",{className:"text-4xl md:text-6xl font-bold bg-gradient-to-r from-green-600 to-green-400 bg-clip-text text-transparent",children:"Choose Your Interests"}),(0,s.jsx)("p",{className:"text-gray-600 text-lg my-8",children:"Find someone to chat with based on what you like."})]})}),(0,s.jsx)(S,{interests:f,onInterestsChange:y,onFindMatch:v,isConnecting:!1,status:n})]},"matchmaking");default:return(0,s.jsxs)(p.P.div,{...j,className:"w-full h-full flex flex-col justify-center items-center",children:[(0,s.jsx)("div",{className:"max-w-3xl mx-auto relative w-full",children:(0,s.jsxs)("div",{className:"text-center mb-12",children:[(0,s.jsxs)("h2",{className:"text-4xl md:text-6xl font-bold bg-gradient-to-r from-green-600 to-green-400 bg-clip-text text-transparent",children:["Real-time",(0,s.jsx)("br",{}),"Anonymous Chat"]}),(0,s.jsx)("p",{className:"text-gray-600 text-lg my-8",children:"Connect with students anonymously and securely."})]})}),(0,s.jsx)("div",{className:"max-w-md mx-auto text-sm space-y-6 text-center",children:(0,s.jsx)("div",{className:"text-red-700 bg-red-50 p-4 rounded-2xl border border-red-200 font-medium",children:(0,s.jsx)("p",{children:"This is a test version of AnimoChat. Not all features are implemented, and you may encounter bugs."})})}),(0,s.jsx)("div",{className:"text-center mt-12",children:(0,s.jsx)(m,{onClick:h,size:"lg",className:"rounded-full py-7 px-8 bg-green-600 hover:bg-green-700 text-white font-bold text-lg",children:"Get Started"})})]},"intro")}})()})}),"chat"!==e&&(0,s.jsxs)("footer",{className:"text-xs text-gray-500 text-center py-4 shrink-0",children:[(0,s.jsxs)("h3",{className:"py-4",children:["Created by developers from"," ",(0,s.jsx)("span",{className:"text-green-700 font-semibold",children:"De La Salle Lipa"})]}),t&&(0,s.jsxs)("p",{className:"font-mono text-gray-400 text-[10px] mt-2",children:["Your User ID: ",t]})]})]})})}let ed=e=>{let{className:t=""}=e;return(0,s.jsx)("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})})},eu=e=>{let{size:t=24,className:n=""}=e;return(0,s.jsxs)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,s.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})},em=e=>{let{size:t=32,className:n=""}=e;return(0,s.jsxs)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1"}),(0,s.jsx)("line",{x1:"12",y1:"7",x2:"12",y2:"13"}),(0,s.jsx)("line",{x1:"9",y1:"10",x2:"15",y2:"10"})]})},ex=()=>(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),eh=e=>{let{isOpen:t,onClose:n,onSubmit:r}=e,[i,l]=(0,a.useState)(""),[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[x,h]=(0,a.useState)(!1),g=(0,a.useRef)(null);if((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),(0,a.useEffect)(()=>{if(t){var e;null==(e=g.current)||e.focus(),l(""),c(!1),u(null),h(!1)}},[t]),!t)return null;let f=async e=>{if(e.preventDefault(),!i.trim())return void u("Feedback cannot be empty.");c(!0),u(null);try{await r(i),h(!0),setTimeout(()=>{n()},2e3)}catch(e){u("Failed to submit feedback. Please try again."),console.error(e)}finally{c(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center","aria-modal":"true",role:"dialog",children:(0,s.jsxs)("div",{ref:g,tabIndex:-1,className:"bg-white rounded-2xl shadow-2xl w-full max-w-md m-4 p-8 relative",children:[(0,s.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close dialog",children:(0,s.jsx)(eu,{size:24})}),(0,s.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,s.jsx)("div",{className:"bg-green-100 p-3 rounded-full mb-4",children:(0,s.jsx)(em,{className:"text-green-600",size:32})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Got a suggestion?"}),(0,s.jsx)("p",{className:"text-gray-500 mb-6",children:"We'd love to hear your ideas for new features or improvements."})]}),x?(0,s.jsx)("div",{className:"text-center p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,s.jsx)("p",{className:"font-semibold text-green-700",children:"Thank you! Your feedback has been submitted."})}):(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"feedback-content",className:"sr-only",children:"Your suggestion"}),(0,s.jsx)("textarea",{id:"feedback-content",value:i,onChange:e=>l(e.target.value),placeholder:"Type your suggestion here...",className:"w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",required:!0})]}),d&&(0,s.jsx)("p",{className:"text-red-600 text-sm text-center",children:d}),(0,s.jsxs)(m,{type:"submit",disabled:o,className:"w-full rounded-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold text-base disabled:bg-gray-400 disabled:cursor-wait flex items-center justify-center transition-colors",children:[o&&(0,s.jsx)(ex,{}),o?"Submitting...":"Submit Feedback"]})]})]})})},eg=()=>{let[e,t]=(0,a.useState)(!1),n=async e=>{console.log("Submitting feedback:",e),await new Promise(e=>setTimeout(e,1e3))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:"\n        @keyframes gentle-wrench-turn {\n          0%, 100% { transform: rotate(-8deg); }\n          50% { transform: rotate(8deg); }\n        }\n        .animate-wrench {\n          animation: gentle-wrench-turn 3s ease-in-out infinite;\n        }\n\n        @keyframes progress-bar-shine {\n          0% { transform: translateX(-100%) skewX(-30deg); }\n          100% { transform: translateX(350%) skewX(-30deg); }\n        }\n        .progress-shine::after {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 33%;\n          height: 100%;\n          background: rgba(255, 255, 255, 0.4);\n          animation: progress-bar-shine 2.5s infinite linear;\n        }\n      "}),(0,s.jsxs)("div",{className:"bg-gray-50 min-h-screen flex flex-col items-center justify-center text-center p-4 font-sans overflow-hidden",children:[(0,s.jsxs)("div",{className:"max-w-md w-full bg-white p-8 sm:p-10 rounded-2xl shadow-xl border border-gray-200",children:[(0,s.jsx)("div",{className:"mx-auto bg-green-100 p-4 rounded-full w-20 h-20 flex items-center justify-center mb-6 animate-wrench",children:(0,s.jsx)(ed,{className:"w-10 h-10 text-green-600"})}),(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"Under Maintenance"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 mb-4",children:"We'll be back up soon!"}),(0,s.jsx)("p",{className:"text-md text-gray-500 mb-8",children:"We're just polishing things up to make your experience even better."}),(0,s.jsx)("div",{className:"w-full bg-green-200 rounded-full h-4 mb-8 overflow-hidden relative",children:(0,s.jsx)("div",{className:"bg-green-500 h-4 rounded-full w-3/4 progress-shine"})}),(0,s.jsx)("button",{onClick:()=>t(!0),className:"px-8 py-3 bg-green-600 text-white font-semibold rounded-full hover:bg-green-700 transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Leave Feedback"})]}),(0,s.jsx)("p",{className:"mt-8 text-sm text-gray-400",children:"Patience is a virtue, and so is great software!"})]}),(0,s.jsx)(eh,{isOpen:e,onClose:()=>t(!1),onSubmit:n})]})},ef=()=>{let[e,t]=(0,a.useState)(!1),[n,s]=(0,a.useState)(!0),[r,i]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("https://animochat-turn-server.onrender.com/maintenance");if(503===e.status)t(!0);else if(e.ok){let n=await e.json();"MAINTENANCE"===n.state?t(!0):t(!1)}else throw Error("Failed to fetch status: ".concat(e.statusText))}catch(n){console.error("Failed to check maintenance status:",n);let e=n instanceof Error?n.message:"An unknown error occurred.";i("Could not connect to the service. Please try again later. (".concat(e,")")),t(!0)}finally{s(!1)}})()},[]),{isMaintenanceMode:e,isLoading:n,error:r}};function ep(){let{isMaintenanceMode:e,isLoading:t,error:n}=ef();return t?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsx)("p",{className:"text-gray-500 text-lg",children:"Checking service status..."})}):e?(0,s.jsx)(eg,{}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(ec,{})})}},9732:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[817,545,441,684,358],()=>t(6379)),_N_E=e.O()}]);