(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[252],{1613:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var s=a(5155),r=a(2115),n=a(7168),l=a(9852),i=a(4416),c=a(9946);let o=(0,c.A)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),d=(0,c.A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),x=(0,c.A)("flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),h=(0,c.A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),m=(0,c.A)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var u=a(7580);let g=(0,c.A)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),p=(0,c.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var j=a(9545);let y=(0,c.A)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),f=(0,c.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),v=(0,c.A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),N=(0,c.A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var b=a(9103),w=a(7859),k=a(760),A=a(662),C=a(8437),z=a(7596),S=a(9597);function M(e){let{room:t,onLeave:a}=e,{user:n,session:l}=(0,C.A)(),{chat:i}=(0,z.c)();return(0,r.useEffect)(()=>{n&&t&&i.connectToExistingSession({chatId:t.id,chatServerUrl:t.serverUrl})},[n,t]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(S.wy,{children:(0,s.jsx)(A.A,{groupChat:!0,name:t.name,onBack:()=>{i.disconnect(),a()}})})})}a(6251);var E=a(9698);let P=(0,r.createContext)(void 0);function _(e){let{children:t}=e,[a,n]=(0,r.useState)(E.zQ),[l,i]=(0,r.useState)("light"),c=(0,r.useMemo)(()=>({theme:a,mode:l,setMode:i,setTheme:n}),[a,l]);return(0,s.jsx)(P.Provider,{value:c,children:t})}var L=a(7863);let O=e=>{let{className:t}=e;return(0,s.jsx)(w.P.div,{animate:{rotate:360},transition:{duration:1,repeat:Number.POSITIVE_INFINITY,ease:"linear"},className:"w-4 h-4 border-2 border-green-200 border-t-green-500 rounded-full ".concat(t)})},T=e=>{let{isOpen:t,onClose:a,onSubmit:c,isCreating:o,error:d}=e,[x,h]=(0,r.useState)(""),[m,u]=(0,r.useState)("10");return(0,s.jsx)(k.N,{children:t&&(0,s.jsx)(w.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4 backdrop-blur-sm",onClick:a,children:(0,s.jsx)(w.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:300,damping:25},className:"bg-white rounded-xl shadow-xl w-full max-w-sm border border-green-100",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"New Room"}),(0,s.jsx)(n.$,{variant:"ghost",size:"icon",onClick:a,className:"h-8 w-8",children:(0,s.jsx)(i.A,{size:16})})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=Number.parseInt(m,10);x.trim()&&!isNaN(t)&&t>1&&c(x.trim(),t)},className:"space-y-4",children:[(0,s.jsx)(l.p,{placeholder:"Room name",value:x,onChange:e=>h(e.target.value),className:"h-10 border-green-200 focus:ring-green-500",required:!0,maxLength:50}),(0,s.jsx)(l.p,{type:"number",placeholder:"Max participants",value:m,onChange:e=>u(e.target.value),className:"h-10 border-green-200 focus:ring-green-500",required:!0,min:"2",max:"100"}),d&&(0,s.jsx)("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded",children:d}),(0,s.jsx)(n.$,{type:"submit",className:"w-full h-10 bg-green-600 hover:bg-green-700 text-white",disabled:o,children:o?(0,s.jsx)(O,{}):"Create"})]})]})})})})},I=e=>{var t,a;let{room:r,onJoin:n}=e,l=r.participants.length/r.max_participants,i=l<.3?{label:"Quiet",icon:o,color:"text-blue-500 bg-blue-50"}:l<.6?{label:"Active",icon:d,color:"text-green-500 bg-green-50"}:l<.8?{label:"Buzzing",icon:x,color:"text-orange-500 bg-orange-50"}:{label:"Popular",icon:h,color:"text-purple-500 bg-purple-50"};return(0,s.jsxs)(w.P.div,{layout:!0,variants:{hidden:{opacity:0,x:-20},visible:{opacity:1,x:0},exit:{opacity:0,x:20}},whileHover:{backgroundColor:"rgba(16, 185, 129, 0.02)"},className:"flex items-center justify-between p-4 border-b border-gray-100 hover:bg-green-50/30 cursor-pointer transition-colors group",onClick:n,children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(m,{size:16,className:"text-green-600"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:r.name}),(0,s.jsx)("div",{className:"px-2 py-0.5 rounded-full text-xs font-medium ".concat(i.color),children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(i.icon,{size:10}),i.label]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(u.A,{size:12}),(0,s.jsxs)("span",{children:[r.participants.length,"/",r.max_participants]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-1.5 overflow-hidden",children:(0,s.jsx)(w.P.div,{className:"h-full bg-green-500 rounded-full",initial:{width:0},animate:{width:"".concat(100*l,"%")},transition:{duration:.8,ease:"easeOut"}})}),(0,s.jsxs)("span",{className:"text-xs",children:[Math.round(100*l),"%"]})]})]}),(0,s.jsx)("div",{className:"text-sm text-gray-500 gap-4 mt-2",children:r.recent_message&&(0,s.jsxs)("span",{children:[(0,s.jsx)("b",{children:null!=(a=null==(t=r.recent_message)?void 0:t.senderNickname)?a:"Someone"}),": ",r.recent_message.content]})})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(g,{size:6,className:"text-green-500 fill-current"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Online"})]}),(0,s.jsx)(p,{size:16,className:"text-gray-400 group-hover:text-green-500 transition-colors"})]})]})},R=e=>{let{icon:t,title:a,message:r}=e;return(0,s.jsxs)(w.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col items-center justify-center text-center py-16 px-8",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mb-4",children:(0,s.jsx)(t,{size:24,className:"text-gray-400"})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:a}),(0,s.jsx)("p",{className:"text-gray-500 text-sm max-w-sm",children:r})]})};function q(){return(0,s.jsx)(C.O,{children:(0,s.jsx)(H,{children:(0,s.jsx)(F,{})})})}function F(){let{user:e}=(0,C.A)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(L.y,{isGroupChat:!0,user:e,children:(0,s.jsx)(U,{})})})}function H(e){let{children:t}=e,{error:a,isLoading:r}=(0,C.A)();return r?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(O,{className:"mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):a?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(j.A,{className:"text-red-600",size:24})}),(0,s.jsx)("h1",{className:"text-lg font-medium text-red-600 mb-2",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:a})]})}):(0,s.jsx)(s.Fragment,{children:t})}function U(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)([]),[c,o]=(0,r.useState)([]),[d,x]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null),[u,g]=(0,r.useState)(null),[p,A]=(0,r.useState)(""),[z,S]=(0,r.useState)(!1),[E,P]=(0,r.useState)(!1),[L,q]=(0,r.useState)(null),{user:F,session:H}=(0,C.A)(),U=async()=>{x(!0),m(null);try{let e=await fetch("https://animochat-service-discovery.onrender.com/discover/chat-service/1.0.0/all");if(!e.ok)throw Error("Discovery service failed (Status: ".concat(e.status,")"));let a=(await e.json()).filter(e=>"RUNNING"===e.status);if(t(a),0===a.length)throw Error("No active chat servers found to host rooms.");let s=a.map(async e=>{try{let t=e.url.endsWith("/")?e.url.slice(0,-1):e.url,a=await fetch("".concat(t,"/rooms"));if(!a.ok)return[];return(await a.json()).map(t=>({...t,serverUrl:e.url}))}catch(e){return[]}}),r=(await Promise.all(s)).flat().sort((e,t)=>{let a=e.participants.length;return t.participants.length-a});i(r),o(r)}catch(e){e instanceof Error?m(e.message):m("An unknown error occurred.")}finally{x(!1)}};(0,r.useEffect)(()=>{U()},[]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{o(a.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())))},200);return()=>clearTimeout(e)},[p,a]);let $=async(t,a)=>{P(!0),q(null);let s=e[0];if(!s){q("No available chat server."),P(!1);return}try{let e=s.url.endsWith("/")?s.url.slice(0,-1):s.url,r=await fetch("".concat(e,"/create-room"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((null==H?void 0:H.access_token)||"")},body:JSON.stringify({name:t,maxParticipants:a})});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to create room.")}S(!1),await U()}catch(e){e instanceof Error?q(e.message):q("An unexpected error occurred.")}finally{P(!1)}};return u?(0,s.jsx)("div",{className:"h-[100dvh] overflow-clip",children:(0,s.jsx)(_,{children:(0,s.jsx)(M,{room:u,onLeave:()=>g(null)})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{isOpen:z,onClose:()=>S(!1),onSubmit:$,isCreating:E,error:L}),(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(n.$,{variant:"ghost",onClick:()=>{var e,t;null==(t=window)||null==(e=t.history)||e.back()},children:(0,s.jsx)(v,{})}),(0,s.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(N,{className:"text-white w-5 h-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Chat Rooms"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[a.length," rooms available"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-grow",children:[(0,s.jsx)(f,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"}),(0,s.jsx)(l.p,{placeholder:"Search rooms...",value:p,onChange:e=>A(e.target.value),className:"pl-10 pr-4 h-10 w-full md:w-48 border-gray-300 focus:ring-green-500 focus:border-green-500 rounded-lg"})]}),(0,s.jsxs)(n.$,{onClick:()=>S(!0),className:"bg-green-600 hover:bg-green-700 text-white h-10 w-10 md:w-auto md:px-4 flex-shrink-0",children:[(0,s.jsx)(b.A,{size:20,className:"md:mr-2"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"New Room"})]})]})]}),(0,s.jsx)(k.N,{mode:"wait",children:d?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(O,{}),(0,s.jsx)("span",{className:"text-gray-600",children:"Loading rooms..."})]})}):h?(0,s.jsx)(R,{icon:j.A,title:"Could Not Load Rooms",message:h}):0===a.length?(0,s.jsx)(R,{icon:y,title:"No Rooms Available",message:"There are currently no public chat rooms. Create one to get started!"}):0===c.length&&p?(0,s.jsx)(R,{icon:f,title:"No Rooms Found",message:'No rooms match "'.concat(p,'". Try a different search term.')}):(0,s.jsx)(w.P.div,{initial:"hidden",animate:"visible",exit:"exit",variants:{visible:{transition:{staggerChildren:.05}}},className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.map(e=>(0,s.jsx)(I,{room:e,onJoin:()=>g(e)},e.id))})})]})})]})}},9089:(e,t,a)=>{Promise.resolve().then(a.bind(a,1613))},9545:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("server-crash",[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[386,889,610,441,684,358],()=>t(9089)),_N_E=e.O()}]);