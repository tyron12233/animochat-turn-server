(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[252],{55:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>T});var s=t(5155),r=t(2115),i=t(7168),l=t(9852),n=t(4416),c=t(9946);let o=(0,c.A)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),d=(0,c.A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),m=(0,c.A)("flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),h=(0,c.A)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),x=(0,c.A)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var u=t(7580);let g=(0,c.A)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),p=(0,c.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var y=t(9545);let f=(0,c.A)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),j=(0,c.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),v=(0,c.A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),N=(0,c.A)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var b=t(7859),w=t(760),k=t(599),A=t(165),M=t(8437);function C(e){let{room:a,onLeave:t}=e,{user:i,session:l}=(0,M.A)(),{connectToExistingSession:n,messages:c,disconnect:o,onDeleteMessage:d,typingUsers:m,sendMessage:h,participants:x,onChangeNickname:u,onReact:g,status:p,onStartTyping:y,onChangeTheme:f,editMessage:j}=(0,A.m)(l,i,!0);return(0,r.useEffect)(()=>{i&&a&&n({chatId:a.id,chatServerUrl:a.serverUrl})},[i,a]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(k.A,{participants:x,name:a.name,groupChat:!0,messages:c,onEditNickname:u,sendMessage:h,onReact:g,goBack:()=>{t(),o(!0)},onDeleteMessage:d,endChat:()=>{},onStartTyping:y,userId:i.id,cancelMatchmaking:()=>{t(),o(!0)},onEditMessage:j,onChangeTheme:f,newChat:()=>{},typingUsers:m,status:p})})}var z=t(4570);let S=e=>{let{className:a}=e;return(0,s.jsx)(b.P.div,{animate:{rotate:360},transition:{duration:1,repeat:Number.POSITIVE_INFINITY,ease:"linear"},className:"w-4 h-4 border-2 border-green-200 border-t-green-500 rounded-full ".concat(a)})},E=e=>{let{isOpen:a,onClose:t,onSubmit:c,isCreating:o,error:d}=e,[m,h]=(0,r.useState)(""),[x,u]=(0,r.useState)("10");return(0,s.jsx)(w.N,{children:a&&(0,s.jsx)(b.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4 backdrop-blur-sm",onClick:t,children:(0,s.jsx)(b.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:300,damping:25},className:"bg-white rounded-xl shadow-xl w-full max-w-sm border border-green-100",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"New Room"}),(0,s.jsx)(i.$,{variant:"ghost",size:"icon",onClick:t,className:"h-8 w-8",children:(0,s.jsx)(n.A,{size:16})})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a=Number.parseInt(x,10);m.trim()&&!isNaN(a)&&a>1&&c(m.trim(),a)},className:"space-y-4",children:[(0,s.jsx)(l.p,{placeholder:"Room name",value:m,onChange:e=>h(e.target.value),className:"h-10 border-green-200 focus:ring-green-500",required:!0,maxLength:50}),(0,s.jsx)(l.p,{type:"number",placeholder:"Max participants",value:x,onChange:e=>u(e.target.value),className:"h-10 border-green-200 focus:ring-green-500",required:!0,min:"2",max:"100"}),d&&(0,s.jsx)("p",{className:"text-red-500 text-sm bg-red-50 p-2 rounded",children:d}),(0,s.jsx)(i.$,{type:"submit",className:"w-full h-10 bg-green-600 hover:bg-green-700 text-white",disabled:o,children:o?(0,s.jsx)(S,{}):"Create"})]})]})})})})},P=e=>{let{room:a,onJoin:t}=e,r=a.participants/a.max_participants,i=r<.3?{label:"Quiet",icon:o,color:"text-blue-500 bg-blue-50"}:r<.6?{label:"Active",icon:d,color:"text-green-500 bg-green-50"}:r<.8?{label:"Buzzing",icon:m,color:"text-orange-500 bg-orange-50"}:{label:"Popular",icon:h,color:"text-purple-500 bg-purple-50"};return(0,s.jsxs)(b.P.div,{layout:!0,variants:{hidden:{opacity:0,x:-20},visible:{opacity:1,x:0},exit:{opacity:0,x:20}},whileHover:{backgroundColor:"rgba(16, 185, 129, 0.02)"},className:"flex items-center justify-between p-4 border-b border-gray-100 hover:bg-green-50/30 cursor-pointer transition-colors group",onClick:t,children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(x,{size:16,className:"text-green-600"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:a.name}),(0,s.jsx)("div",{className:"px-2 py-0.5 rounded-full text-xs font-medium ".concat(i.color),children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(i.icon,{size:10}),i.label]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(u.A,{size:12}),(0,s.jsxs)("span",{children:[a.participants,"/",a.max_participants]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-16 bg-gray-200 rounded-full h-1.5 overflow-hidden",children:(0,s.jsx)(b.P.div,{className:"h-full bg-green-500 rounded-full",initial:{width:0},animate:{width:"".concat(100*r,"%")},transition:{duration:.8,ease:"easeOut"}})}),(0,s.jsxs)("span",{className:"text-xs",children:[Math.round(100*r),"%"]})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(g,{size:6,className:"text-green-500 fill-current"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Online"})]}),(0,s.jsx)(p,{size:16,className:"text-gray-400 group-hover:text-green-500 transition-colors"})]})]})},L=e=>{let{icon:a,title:t,message:r}=e;return(0,s.jsxs)(b.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex flex-col items-center justify-center text-center py-16 px-8",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center mb-4",children:(0,s.jsx)(a,{size:24,className:"text-gray-400"})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:t}),(0,s.jsx)("p",{className:"text-gray-500 text-sm max-w-sm",children:r})]})};function T(){return(0,s.jsx)(M.O,{children:(0,s.jsx)(_,{children:(0,s.jsx)(I,{})})})}function _(e){let{children:a}=e,{error:t,isLoading:r}=(0,M.A)();return r?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(S,{className:"mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):t?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(y.A,{className:"text-red-600",size:24})}),(0,s.jsx)("h1",{className:"text-lg font-medium text-red-600 mb-2",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:t})]})}):(0,s.jsx)(s.Fragment,{children:a})}function I(){let[e,a]=(0,r.useState)([]),[t,n]=(0,r.useState)([]),[c,o]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),[h,x]=(0,r.useState)(null),[u,g]=(0,r.useState)(null),[p,k]=(0,r.useState)(""),[A,T]=(0,r.useState)(!1),[_,I]=(0,r.useState)(!1),[O,R]=(0,r.useState)(null),{user:q,session:F}=(0,M.A)(),H=async()=>{m(!0),x(null);try{let e=await fetch("https://animochat-service-discovery.onrender.com/discover/chat-service/1.0.0/all");if(!e.ok)throw Error("Discovery service failed (Status: ".concat(e.status,")"));let t=(await e.json()).filter(e=>"RUNNING"===e.status);if(a(t),0===t.length)throw Error("No active chat servers found to host rooms.");let s=t.map(async e=>{try{let a=e.url.endsWith("/")?e.url.slice(0,-1):e.url,t=await fetch("".concat(a,"/rooms"));if(!t.ok)return[];return(await t.json()).map(a=>({...a,serverUrl:e.url}))}catch(e){return[]}}),r=(await Promise.all(s)).flat();n(r),o(r)}catch(e){e instanceof Error?x(e.message):x("An unknown error occurred.")}finally{m(!1)}};(0,r.useEffect)(()=>{H()},[]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{o(t.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())))},200);return()=>clearTimeout(e)},[p,t]);let U=async(a,t)=>{I(!0),R(null);let s=e[0];if(!s){R("No available chat server."),I(!1);return}try{let e=s.url.endsWith("/")?s.url.slice(0,-1):s.url,r=await fetch("".concat(e,"/create-room"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((null==F?void 0:F.access_token)||"")},body:JSON.stringify({name:a,maxParticipants:t})});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to create room.")}T(!1),await H()}catch(e){e instanceof Error?R(e.message):R("An unexpected error occurred.")}finally{I(!1)}};return u?(0,s.jsx)("div",{className:"h-[100dvh] overflow-clip",children:(0,s.jsx)(z.h,{children:(0,s.jsx)(C,{room:u,onLeave:()=>g(null)})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E,{isOpen:A,onClose:()=>T(!1),onSubmit:U,isCreating:_,error:O}),(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(v,{className:"text-white w-5 h-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Chat Rooms"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[t.length," rooms available"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-grow",children:[(0,s.jsx)(j,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"}),(0,s.jsx)(l.p,{placeholder:"Search rooms...",value:p,onChange:e=>k(e.target.value),className:"pl-10 pr-4 h-10 w-full md:w-48 border-gray-300 focus:ring-green-500 focus:border-green-500 rounded-lg"})]}),(0,s.jsxs)(i.$,{onClick:()=>T(!0),className:"bg-green-600 hover:bg-green-700 text-white h-10 w-10 md:w-auto md:px-4 flex-shrink-0",children:[(0,s.jsx)(N,{size:20,className:"md:mr-2"}),(0,s.jsx)("span",{className:"hidden md:inline",children:"New Room"})]})]})]}),(0,s.jsx)(w.N,{mode:"wait",children:d?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(S,{}),(0,s.jsx)("span",{className:"text-gray-600",children:"Loading rooms..."})]})}):h?(0,s.jsx)(L,{icon:y.A,title:"Could Not Load Rooms",message:h}):0===t.length?(0,s.jsx)(L,{icon:f,title:"No Rooms Available",message:"There are currently no public chat rooms. Create one to get started!"}):0===c.length&&p?(0,s.jsx)(L,{icon:j,title:"No Rooms Found",message:'No rooms match "'.concat(p,'". Try a different search term.')}):(0,s.jsx)(b.P.div,{initial:"hidden",animate:"visible",exit:"exit",variants:{visible:{transition:{staggerChildren:.05}}},className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.map(e=>(0,s.jsx)(P,{room:e,onJoin:()=>g(e)},e.id))})})]})})]})}},9089:(e,a,t)=>{Promise.resolve().then(t.bind(t,55))},9545:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(9946).A)("server-crash",[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]])}},e=>{var a=a=>e(e.s=a);e.O(0,[817,239,719,441,684,358],()=>a(9089)),_N_E=e.O()}]);