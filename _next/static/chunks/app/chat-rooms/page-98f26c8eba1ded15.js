(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[252],{6425:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var s=a(5155),r=a(2115),i=a(7168),l=a(9852),n=a(9946);let c=(0,n.A)("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);var o=a(4416),d=a(7580),h=a(9545);let x=(0,n.A)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),m=(0,n.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var u=a(760),p=a(7859),g=a(6930),f=a(165),y=a(8437);function j(e){let{room:t,onLeave:a}=e,{user:i,session:l}=(0,y.A)(),{connectToExistingSession:n,messages:c,disconnect:o,onDeleteMessage:d,typingUsers:h,sendMessage:x,participants:m,onChangeNickname:u,onReact:p,status:j,onStartTyping:v,onChangeTheme:b,editMessage:N}=(0,f.m)(l,i,!0);return(0,r.useEffect)(()=>{n({chatId:t.id,chatServerUrl:t.serverUrl})},[t]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(g.A,{participants:m,name:t.name,groupChat:!0,messages:c,onEditNickname:u,sendMessage:x,onReact:p,goBack:()=>{a(),o(!0)},onDeleteMessage:d,endChat:()=>{},onStartTyping:v,userId:i.id,cancelMatchmaking:()=>{a(),o(!0)},onEditMessage:N,onChangeTheme:b,newChat:()=>{},typingUsers:h,status:j})})}var v=a(4570);let b=e=>{let{className:t}=e;return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"animate-spin ".concat(t),children:(0,s.jsx)("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})})},N=e=>{let{isOpen:t,onClose:a,onSubmit:n,isCreating:d,error:h}=e,[x,m]=(0,r.useState)(""),[g,f]=(0,r.useState)("10");return(0,s.jsx)(u.N,{children:t&&(0,s.jsx)(p.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm",onClick:a,children:(0,s.jsx)(p.P.div,{initial:{scale:.95,y:30,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.95,y:30,opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"bg-white/80 backdrop-blur-lg border border-gray-200/50 rounded-2xl shadow-2xl w-full max-w-md",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"p-6 sm:p-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,s.jsx)(c,{className:"text-green-500"}),"Create a New Room"]}),(0,s.jsx)(i.$,{variant:"ghost",size:"icon",onClick:a,className:"rounded-full text-gray-500 hover:bg-gray-500/10",children:(0,s.jsx)(o.A,{size:20})})]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=parseInt(g,10);x.trim()&&!isNaN(t)&&t>1&&n(x.trim(),t)},className:"space-y-6",children:[(0,s.jsx)(l.p,{placeholder:"Room Name",value:x,onChange:e=>m(e.target.value),className:"py-6 px-4 bg-white/50 border-gray-300 rounded-lg focus:ring-green-500",required:!0,maxLength:50}),(0,s.jsx)(l.p,{type:"number",placeholder:"Max Participants",value:g,onChange:e=>f(e.target.value),className:"py-6 px-4 bg-white/50 border-gray-300 rounded-lg focus:ring-green-500",required:!0,min:"2",max:"100"}),h&&(0,s.jsx)("p",{className:"text-red-500 text-sm",children:h}),(0,s.jsx)(i.$,{type:"submit",className:"w-full py-6 bg-green-600 hover:bg-green-700 font-bold text-base text-white rounded-lg transition-all duration-300 shadow-lg hover:shadow-green-500/30",disabled:d,children:d?(0,s.jsx)(b,{}):"Create Room"})]})]})})})})},w=e=>{let{room:t,onJoin:a}=e;return(0,s.jsxs)(p.P.div,{layout:!0,variants:{hidden:{y:30,opacity:0,scale:.95},visible:{y:0,opacity:1,scale:1,transition:{type:"spring",stiffness:250,damping:35}},exit:{y:-30,opacity:0,scale:.95}},whileHover:{scale:1.03,y:-5},className:"bg-white/60 backdrop-blur-md rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden cursor-pointer flex flex-col border border-gray-200/30",onClick:a,children:[(0,s.jsx)("div",{className:"bg-green-500 h-2 w-full"}),(0,s.jsxs)("div",{className:"p-6 flex-grow flex flex-col justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 truncate mb-2",children:t.name}),(0,s.jsxs)("div",{className:"flex items-center text-gray-600 text-sm",children:[(0,s.jsx)(d.A,{size:16,className:"mr-2 flex-shrink-0"}),(0,s.jsxs)("span",{className:"font-medium",children:[t.participants," / ",t.max_participants]}),(0,s.jsx)("span",{className:"mx-2",children:"\xb7"}),(0,s.jsx)("span",{className:"text-gray-500",children:t.participants<.5*t.max_participants?"Quiet":t.participants<.8*t.max_participants?"Active":"Popular"})]})]}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-end text-sm font-semibold text-green-600",children:["Join Room",(0,s.jsx)(p.P.span,{initial:{x:0},whileHover:{x:4},className:"ml-1 transition-transform",children:"â†’"})]})})]})]})},k=e=>{let{icon:t,title:a,message:r}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 bg-white/30 p-12 rounded-2xl backdrop-blur-sm",children:[(0,s.jsx)(t,{size:48,className:"mb-4 text-gray-400"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:a}),(0,s.jsx)("p",{className:"text-sm mt-2 max-w-sm",children:r})]})};function C(){return(0,s.jsx)(y.O,{children:(0,s.jsx)(M,{children:(0,s.jsx)(_,{})})})}function M(e){let{children:t}=e,{error:a,isLoading:r,user:i}=(0,y.A)();return r?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsx)("p",{className:"text-gray-500 text-lg",children:"Loading user data..."})}):a?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(S,{}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-red-600",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-500 mt-2",children:a})]})}):(0,s.jsx)(s.Fragment,{children:t})}function S(){return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}function _(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)([]),[n,c]=(0,r.useState)([]),[o,d]=(0,r.useState)(!0),[g,f]=(0,r.useState)(null),[y,C]=(0,r.useState)(null),[M,S]=(0,r.useState)(""),[_,A]=(0,r.useState)(!1),[z,E]=(0,r.useState)(!1),[L,P]=(0,r.useState)(null),R=async()=>{d(!0),f(null);try{let e=await fetch("https://animochat-service-discovery.onrender.com/discover/chat-service/1.0.0/all");if(!e.ok)throw Error("Discovery service failed (Status: ".concat(e.status,")"));let a=(await e.json()).filter(e=>"RUNNING"===e.status);if(t(a),0===a.length)throw Error("No active chat servers found to host rooms.");let s=a.map(async e=>{try{let t=e.url.endsWith("/")?e.url.slice(0,-1):e.url,a=await fetch("".concat(t,"/rooms"));if(!a.ok)return[];return(await a.json()).map(t=>({...t,serverUrl:e.url}))}catch(e){return[]}}),r=(await Promise.all(s)).flat();i(r),c(r)}catch(e){e instanceof Error?f(e.message):f("An unknown error occurred.")}finally{d(!1)}};(0,r.useEffect)(()=>{R()},[]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{c(a.filter(e=>e.name.toLowerCase().includes(M.toLowerCase())))},200);return()=>clearTimeout(e)},[M,a]);let T=async(t,a)=>{E(!0),P(null);let s=e[0];if(!s){P("No available chat server."),E(!1);return}try{let e=s.url.endsWith("/")?s.url.slice(0,-1):s.url,r=await fetch("".concat(e,"/create-room"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,maxParticipants:a})});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to create room.")}A(!1),await R()}catch(e){e instanceof Error?P(e.message):P("An unexpected error occurred.")}finally{E(!1)}};return y?(0,s.jsx)(v.h,{children:(0,s.jsx)(j,{room:y,onLeave:()=>C(null)})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N,{isOpen:_,onClose:()=>A(!1),onSubmit:T,isCreating:z,error:L}),(0,s.jsxs)("div",{className:"fixed inset-0 -z-10 h-full w-full bg-white",children:[(0,s.jsx)("div",{className:"fixed inset-0 -z-10 h-full w-full bg-[linear-gradient(to_right,#8080800a_1px,transparent_1px),linear-gradient(to_bottom,#8080800a_1px,transparent_1px)] bg-[size:14px_24px]"}),(0,s.jsx)("div",{className:"fixed bottom-0 left-0 right-0 top-0 bg-[radial-gradient(circle_500px_at_50%_200px,#10b98122,transparent)]"})]}),(0,s.jsx)("div",{className:"min-h-screen p-4 sm:p-6 lg:p-8",children:(0,s.jsxs)("div",{className:"max-w-screen-xl mx-auto",children:[(0,s.jsx)("header",{className:"sticky top-6 z-40 bg-white/70 backdrop-blur-lg p-4 rounded-2xl shadow-lg shadow-gray-500/5 border border-gray-200/50 mb-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Public Chat Rooms"}),(0,s.jsx)("div",{className:"flex items-center gap-2 sm:gap-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(m,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,s.jsx)(l.p,{placeholder:"Search rooms...",value:M,onChange:e=>S(e.target.value),className:"pl-9 pr-3 py-2 h-10 w-40 sm:w-56 rounded-full bg-gray-500/10 border-transparent focus:bg-white focus:ring-2 focus:ring-green-500"})]})})]})}),(0,s.jsx)("main",{children:o?(0,s.jsx)("div",{className:"flex items-center justify-center pt-20",children:(0,s.jsx)(b,{className:"text-green-500"})}):g?(0,s.jsx)(k,{icon:h.A,title:"Could Not Load Rooms",message:g}):0===a.length?(0,s.jsx)(k,{icon:x,title:"No Rooms Available",message:"There are currently no public chat rooms. Why not start one?"}):0===n.length&&M?(0,s.jsx)(k,{icon:m,title:"No Rooms Found",message:'Your search for "'.concat(M,'" did not match any rooms.')}):(0,s.jsx)(u.N,{children:(0,s.jsx)(p.P.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",initial:"hidden",animate:"visible",exit:"exit",variants:{visible:{transition:{staggerChildren:.07}}},children:n.map(e=>(0,s.jsx)(w,{room:e,onJoin:()=>C(e)},e.id))})})})]})})]})}},9089:(e,t,a)=>{Promise.resolve().then(a.bind(a,6425))},9545:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("server-crash",[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[817,822,566,441,684,358],()=>t(9089)),_N_E=e.O()}]);