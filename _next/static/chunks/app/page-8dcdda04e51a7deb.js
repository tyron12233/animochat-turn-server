(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3287:()=>{},5909:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eF});var r=n(5155);function a(){return(0,r.jsxs)("div",{className:"fixed inset-0 overflow-hidden pointer-events-none -z-5",children:[(0,r.jsx)("div",{className:"absolute top-1/4 left-1/4 w-24 h-24 bg-gradient-to-r from-green-100 to-green-50 rounded-full opacity-50 animate-float mix-blend-multiply"}),(0,r.jsx)("div",{className:"absolute top-1/3 right-32 w-48 h-48 bg-green-100 rounded-full opacity-20 animate-blob animation-delay-2000"}),(0,r.jsx)("div",{className:"absolute top-2/3 left-16 w-16 h-16 bg-green-50 rotate-45 opacity-30 animate-float animation-delay-3000"}),(0,r.jsx)("div",{className:"absolute bottom-32 right-1/4",children:(0,r.jsx)("div",{className:"w-32 h-32 border-4 border-green-100 rounded-full animate-pulse opacity-30"})}),(0,r.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,r.jsx)("div",{className:"h-full w-full bg-[linear-gradient(to_right,#80808012_1px,transparent_1px),linear-gradient(to_bottom,#80808012_1px,transparent_1px)] bg-[size:24px_24px]"})}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-1/3 h-full animate-line",children:(0,r.jsx)("div",{className:"w-px h-full bg-gradient-to-b from-transparent via-green-100 to-transparent"})})]})}var s=n(2115),i=n(2596),o=n(9688);function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.QP)((0,i.$)(t))}let c=s.forwardRef((e,t)=>{let{className:n,type:a,...s}=e;return(0,r.jsx)("input",{type:a,className:l("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...s})});c.displayName="Input";var d=n(4624);let u=(0,n(2085).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function g(e){let{className:t,variant:n,size:a,asChild:s=!1,...i}=e,o=s?d.DX:"button";return(0,r.jsx)(o,{"data-slot":"button",className:l(u({variant:n,size:a,className:t})),...i})}var m=n(6474),h=n(4416),f=n(5736);let x=(0,n(4982).UU)("https://wkafplnaexyyuobfufxa.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndrYWZwbG5hZXh5eXVvYmZ1ZnhhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0NjYwODEsImV4cCI6MjA2MTA0MjA4MX0.Sp9g2aWN24QoymYPoYJbxInnFNMautc26uJ1ba6Dvdc");var b=n(7859),p=n(760),y=n(9300),k=n.n(y);let v=e=>{let{children:t,className:n}=e,a=(0,s.useRef)(null),[i,o]=(0,s.useState)("auto");return(0,s.useEffect)(()=>{if(a.current){let e=new ResizeObserver(e=>{o(e[0].contentRect.height)});return e.observe(a.current),()=>{e.disconnect()}}},[]),(0,r.jsx)(b.P.div,{className:k()(n,"overflow-hidden"),style:{height:i},animate:{height:i},transition:{duration:.14},children:(0,r.jsx)("div",{ref:a,children:t})})},j=()=>{let[e,t]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"w-[350px] max-w-full mx-auto mb-2 my-4 bg-blue-50 border border-blue-200 rounded-lg shadow-sm transition-all duration-300",children:[(0,r.jsxs)("button",{onClick:()=>t(!e),className:"w-full flex justify-between items-center p-4 text-left font-semibold text-blue-800 hover:bg-blue-100 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400 rounded-lg","aria-expanded":e,"aria-controls":"updatesbox-content",children:[(0,r.jsx)("span",{children:"P2P Chat Development Updates"}),(0,r.jsx)(m.A,{size:20,className:"transform transition-transform duration-300 ".concat(e?"rotate-180":"")})]}),e&&(0,r.jsxs)(b.P.div,{id:"updatesbox-content",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},className:"p-4 border-t border-blue-200 text-sm text-blue-900 overflow-hidden",children:[(0,r.jsx)("p",{className:"font-semibold",children:"First, a huge thank you to everyone who has been using the app and participating in our initial testing phase. Your feedback has been invaluable as we work to build the best chat experience possible."}),(0,r.jsx)("br",{}),(0,r.jsx)("p",{className:"mb-3",children:"During this test, we used a Peer-to-Peer (P2P) system, where users' devices connected directly to each other. We learned that this approach wasn't as effective as we'd hoped, as many devices, browsers, and network types couldn't form stable connections."}),(0,r.jsx)("p",{children:"Our top priority is a seamless experience for every user. That's why we're moving to a new and improved system with a powerful network of dedicated chat servers to act as a robust middleman. (While still being cost-effective!)"}),(0,r.jsx)("p",{children:"This move is a significant step forward in our mission to provide a stable, fast, and scalable platform for all of our users. We're confident this new architecture will lead to a dramatically better chat experience."}),(0,r.jsx)("br",{}),(0,r.jsx)("p",{children:"happy chatting :D -ts"})]})]})},w=e=>{let{text:t,onRemove:n}=e;return(0,r.jsxs)("div",{className:"tag inline-flex items-center bg-green-600 text-white py-1 px-3 rounded-full m-1 font-medium text-sm transition-all duration-200",children:[(0,r.jsx)("span",{children:t}),(0,r.jsx)("button",{onClick:()=>n(t),className:"ml-2 bg-black/10 hover:bg-black/30 rounded-full w-5 h-5 flex items-center justify-center transition-colors","aria-label":"Remove ".concat(t),children:(0,r.jsx)(h.A,{size:14})})]})},N=()=>(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),C=e=>{let{isOpen:t,onClose:n,onSubmit:a}=e,[i,o]=(0,s.useState)(""),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(!1),y=(0,s.useRef)(null);if((0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),(0,s.useEffect)(()=>{if(t){var e;null==(e=y.current)||e.focus(),o(""),c(!1),u(null),x(!1)}},[t]),!t)return null;let k=async e=>{if(e.preventDefault(),!i.trim())return void u("Feedback cannot be empty.");c(!0),u(null);try{await a(i),x(!0),setTimeout(()=>{n()},2e3)}catch(e){u("Failed to submit feedback. Please try again."),console.error(e)}finally{c(!1)}};return(0,r.jsx)(p.N,{children:t&&(0,r.jsx)(b.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center","aria-modal":"true",role:"dialog",children:(0,r.jsxs)(b.P.div,{ref:y,tabIndex:-1,initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},transition:{duration:.2,ease:"easeOut"},className:"bg-white rounded-2xl shadow-2xl w-full max-w-md m-4 p-8 relative",children:[(0,r.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close dialog",children:(0,r.jsx)(h.A,{size:24})}),(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("div",{className:"bg-green-100 p-3 rounded-full mb-4",children:(0,r.jsx)(f.A,{className:"text-green-600",size:32})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Got a suggestion?"}),(0,r.jsx)("p",{className:"text-gray-500 mb-6",children:"We'd love to hear your ideas for new features or improvements."})]}),m?(0,r.jsx)("div",{className:"text-center p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsx)("p",{className:"font-semibold text-green-700",children:"Thank you! Your feedback has been submitted."})}):(0,r.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"feedback-content",className:"sr-only",children:"Your suggestion"}),(0,r.jsx)("textarea",{id:"feedback-content",value:i,onChange:e=>o(e.target.value),placeholder:"Type your suggestion here...",className:"w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",required:!0})]}),d&&(0,r.jsx)("p",{className:"text-red-600 text-sm text-center",children:d}),(0,r.jsxs)(g,{type:"submit",disabled:l,className:"w-full rounded-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold text-base disabled:bg-gray-400 disabled:cursor-wait flex items-center justify-center",children:[l&&(0,r.jsx)(N,{}),l?"Submitting...":"Submit Feedback"]})]})]})})})};function F(e){let{interests:t,onInterestsChange:n,onFindMatch:a,isConnecting:i,status:o}=e,[l,d]=(0,s.useState)(""),[u,m]=(0,s.useState)([]),[h,y]=(0,s.useState)(!0),[k,F]=(0,s.useState)(null),[S,E]=(0,s.useState)(!1),T={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};(0,s.useEffect)(()=>{(async()=>{y(!0);try{let e=await fetch("".concat("https://animochat-turn-server.onrender.com","/interests/popular"));if(!e.ok)throw Error("HTTP error! Status: ".concat(e.status));let t=await e.json();m(t)}catch(e){console.error("Failed to fetch popular interests:",e),F("Could not load topics.")}finally{y(!1)}})()},[]);let _=e=>{let r=e.trim().toUpperCase();r&&!t.has(r)&&n(new Set(t).add(r)),d("")},I=e=>{let r=new Set(t);r.delete(e),n(r)},M=async e=>{let{error:t}=await x.from("suggestions").insert([{content:e}]);if(t)throw console.error("Error submitting feedback to Supabase:",t),t};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"w-[350px] max-w-full mx-auto",children:[(0,r.jsx)(v,{children:(0,r.jsx)("div",{className:"flex flex-wrap justify-center gap-2 pb-4",children:(0,r.jsx)(p.N,{children:Array.from(t).map(e=>(0,r.jsx)(b.P.div,{layout:!0,initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5,transition:{duration:.12}},transition:{type:"spring",stiffness:500,damping:30},children:(0,r.jsx)(w,{text:e,onRemove:I})},e))})})}),(0,r.jsx)(c,{id:"interest-input",type:"text",value:l,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),_(l))},className:"rounded-full py-6 px-6 focus-visible:border-green-500 focus-visible:ring-green-500 ring-offset-1 text-center",placeholder:"Type an interest & press Enter",maxLength:26})]}),(0,r.jsxs)("div",{className:"mt-8 text-center",children:[(0,r.jsx)("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider mb-4",children:"Popular Topics"}),(0,r.jsx)(v,{children:(0,r.jsx)(b.P.div,{className:"flex flex-wrap justify-center gap-2 max-w-md mx-auto",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{delay:.3,staggerChildren:.07,delayChildren:.2}}},initial:"hidden",animate:"visible",children:h?(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Loading topics..."}):k?(0,r.jsx)("p",{className:"text-sm text-red-500",children:k}):0===u.length?(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"No active topics."}):u.map(e=>{let{interest:t,count:n}=e;return(0,r.jsxs)(b.P.button,{variants:T,onClick:()=>_(t),className:"bg-green-100 text-green-800 text-xs font-semibold px-3 py-1.5 rounded-full hover:bg-green-200 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.95},children:[(0,r.jsx)("span",{children:t}),(0,r.jsx)("span",{className:"bg-green-200 text-green-900 text-[10px] font-bold px-1.5 py-0.5 rounded-full ml-2",children:n})]},t)})})})]}),(0,r.jsx)("div",{className:"mt-12 w-[350px] max-w-full mx-auto",children:(0,r.jsx)(g,{onClick:()=>{let e=new Set(t);l.trim()&&!e.has(l.trim().toUpperCase())&&n(e=new Set(e).add(l.trim().toUpperCase())),a(e)},disabled:i||0===t.size&&!l.trim(),className:"w-full rounded-full py-6 bg-green-600 hover:bg-green-700 text-white font-bold text-base disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N,{}),o]}):"Find Match"})}),(0,r.jsx)(j,{}),(0,r.jsx)("div",{className:"text-center mt-6",children:(0,r.jsxs)(g,{variant:"secondary",className:"text-gray-500 hover:text-green-600 transition-colors",onClick:()=>E(!0),children:[(0,r.jsx)(f.A,{size:16,className:"mr-2"}),"We'd love to hear your feedback"]})}),(0,r.jsx)(C,{isOpen:S,onClose:()=>E(!1),onSubmit:M})]})}var S=n(3319);n(9732),n(3287);var E=n(892),T=n(8619),_=n(8829),I=n(4032),M=n(9424);function P(e){let{visible:t,isUserMessage:n,reply:a,onOpenEmojiMenu:s,theme:i,mode:o,isDeleted:l=!1}=e,c={backgroundColor:"transparent",color:i.secondaryText[o]};return(0,r.jsxs)("div",{className:"flex flex-row h-full items-center justify-center space-x-1 self-center ".concat(t?"visible":"invisible"),children:[(0,r.jsx)("div",{className:"".concat(n?"mr-1":"ml-2"," rounded-full transition-colors p-2 cursor-pointer hover:opacity-100 opacity-60"),style:c,onClick:a,children:(0,r.jsx)(I.A,{className:"w-4 h-4",strokeWidth:"2"})}),!l&&(0,r.jsx)("div",{className:"rounded-full transition-colors p-2 cursor-pointer hover:opacity-100 opacity-60",onClick:s,style:c,children:(0,r.jsx)(M.A,{className:"w-4 h-4",strokeWidth:"2"})}),n&&(0,r.jsx)("div",{className:"w-1"})]},"actions")}var A=n(6766);function D(e){let{message:t,isUserMessage:n,theme:a,mode:s}=e;return t?"image"===t.type?(0,r.jsx)(R,{message:t,isUserMessage:n,theme:a,mode:s}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"rounded-t-lg rounded-b-md px-3 pt-2 text-sm opacity-[0.65] pb-[32px] -mb-[32px] -z-10",style:{backgroundColor:a.overlays.replyingPreview.background[s],color:a.overlays.replyingPreview.description[s]},children:(0,r.jsx)("p",{className:"break-words whitespace-pre-wrap",children:"deleted"===t.type?"Deleted message.":t.content})})}):null}function R(e){let{message:t,isUserMessage:n,theme:a,mode:s}=e;return(0,r.jsx)("div",{className:"pb-[32px] -mb-[32px] rounded-t-lg rounded-b-md overflow-hidden",style:{backgroundColor:a.general.background[s]},children:(0,r.jsx)(A.default,{src:t.content,alt:"Reply image",className:"object-contain",width:80,height:100})})}function B(e){let{message:t,user:n,theme:a,mode:s}=e,i=t.reactions;if(!i||0===i.length)return null;let o=i.length,l=Array.from(new Set(i.map(e=>e.emoji)));return i.find(e=>e.user_id===n.id),(0,r.jsx)(b.P.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{duration:.2,ease:"easeOut"},className:"flex justify-end",children:(0,r.jsx)("div",{className:"self-end text-xs relative rounded-full mt-auto border-2 p-1.5 -top-2",style:{backgroundColor:a.reactions.bubble.background[s],borderColor:a.reactions.bubble.border[s],color:a.reactions.bubble.text[s]},children:(0,r.jsxs)("div",{className:"flex justify-center items-center",children:[l.map((e,t)=>(0,r.jsx)("div",{className:"text-center",children:e},t)),o>0&&(0,r.jsx)("p",{className:"pl-1",children:(0,r.jsx)("span",{children:o})})]})})})}var L=n(9597);function O(e){var t,n,a;let{message:i,user:o,hovered:l,reply:c,animate:d=!1,onOpenEmojiMenu:u,onResendMessage:g,theme:m,mode:h,advertisementMessageId:f,onLinkClick:x,onReact:p}=e,y=i.sender===o.id,k=(n=i.hasPrevious,a=i.hasNext,y?"rounded-tl-3xl rounded-bl-3xl ".concat(n?"rounded-tr-sm":"rounded-tr-3xl"," ").concat(a?"rounded-br-sm":"rounded-br-3xl"):"rounded-tr-3xl rounded-br-3xl ".concat(n?"rounded-tl-sm":"rounded-tl-3xl"," ").concat(a?"rounded-bl-sm":"rounded-bl-3xl")),v="sending"===i.status,j="error"===i.status,w=null!=(t=i.edited)&&t,N=i.content,C=function(e){let t=e.trim();if(!t)return!1;let n=t.replace(/\s+/g,""),r=RegExp("(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)","gu"),a=n.match(r);return!!a&&a.join("")===n}(N)&&3>=function(e){let t=e.trim().replace(/\s+/g,""),n=RegExp("(\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F)","gu"),r=t.match(n);return r?r.length:0}(N),F=(0,T.d)(0),S=(0,_.G)(F,y?[0,-30,-40,-50]:[0,30,40,50],[0,.5,.8,1]),E=function(e){let{delay:t=500}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,s.useRef)(null),r=(0,s.useRef)(!1),a=(0,s.useCallback)(()=>{null!==n.current&&(clearTimeout(n.current),n.current=null)},[]),i=(0,s.useCallback)(a=>{r.current=!1,n.current=window.setTimeout(()=>{e(a)},t)},[e,t]),o=(0,s.useCallback)(e=>{r.current=!0,a()},[a]);return{onTouchStart:i,onTouchMove:o,onTouchEnd:(0,s.useCallback)(e=>{r.current||e.stopPropagation(),a()},[a]),onTouchCancel:(0,s.useCallback)(e=>{a()},[a])}}(()=>{"deleted"!==i.type&&u()});return(0,r.jsxs)("div",{className:"relative flex w-full items-center ".concat(y?"justify-end":"justify-start"),children:[(0,r.jsx)(b.P.div,{className:"absolute p-2.5 rounded-full",style:{background:m.accent.faded[h],scale:S},children:(0,r.jsx)(I.A,{className:"w-4 h-4",style:{color:m.accent.main[h]}})}),!j&&y&&(0,r.jsx)("p",{className:"opacity-50 text-[0.70rem] self-end pr-2 pb-2 overflow-clip -mr-[80px] ".concat(f!==i.id||l?"invisible":"visible"),style:{color:m.secondaryText[h]},children:"AnimoChat.com"}),y&&(0,r.jsx)(P,{isUserMessage:i.sender===o.id,visible:l,theme:m,mode:h,reply:c,onOpenEmojiMenu:u,isDeleted:"deleted"===i.type}),j&&y&&(0,r.jsxs)("p",{style:{color:m.errorText[h]},className:"opacity-80 text-[0.70rem] self-end pr-2 pb-2 overflow-clip",children:["Error sending message."," ",(0,r.jsx)("span",{className:"underline cursor-pointer",onClick:()=>g(i),children:"Retry"})]}),(0,r.jsxs)(b.P.div,{id:"message-bubble",dragSnapToOrigin:!0,dragTransition:{bounceDamping:13},drag:"x",dragConstraints:{left:0,right:0},onDrag:(e,t)=>{y&&t.offset.x>0||!y&&t.offset.x<0||F.set(t.offset.x)},onDragEnd:(e,t)=>{(y&&t.offset.x<-50||!y&&t.offset.x>50)&&c(),F.set(0)},whileTap:{scale:.8},style:{x:F,originX:+!!y,WebkitTapHighlightColor:"transparent"},onDoubleClick:()=>p("❤️"),..."deleted"!==i.type&&{onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),u()}},...E,initial:!!d&&{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",duration:.4},className:"max-w-[75%] mb-0.5 flex flex-col ".concat(y?"items-end":"items-start"," ").concat(v?"opacity-50":""),children:[w&&(0,r.jsx)("p",{className:"text-[0.70rem] px-2",style:{color:m.secondaryText[h]},children:"Edited"}),i.replyingTo&&(0,r.jsx)(D,{message:i.replyingTo,isUserMessage:y,theme:m,mode:h}),(null===i.type||void 0===i.type||"text"===i.type||"deleted"===i.type)&&(0,r.jsx)(W,{message:i,user:o,theme:m,mode:h,isUserMessage:y,roundedCorners:k,isLargeEmojiMessage:C,onLinkClick:x}),"image"===i.type&&(0,r.jsx)(z,{user:o,message:i,roundedCorners:k,isUserMessage:y,theme:m,mode:h})]},i.id+"-bubble"),!y&&(0,r.jsx)(P,{visible:l,theme:m,mode:h,isUserMessage:!1,reply:c,onOpenEmojiMenu:u}),!y&&(0,r.jsx)("p",{className:"opacity-50 text-[0.70rem] self-end pl-2 pb-2 -ml-[70px] ".concat(f!==i.id||l?"invisible":"visible"),style:{color:m.secondaryText[h]},children:"AnimoChat.com"})]},i.id)}function z(e){let{user:t,message:n,roundedCorners:a,isUserMessage:i,theme:o,mode:l}=e,[c,d]=(0,s.useState)(!1),u="rounded-3xl ".concat(a," ").concat(i?"rounded-tr-3xl":"rounded-tl-3xl");return(0,r.jsxs)("div",{id:"image-message-container",onClick:()=>d(!0),style:{cursor:"pointer"},children:[(0,r.jsxs)("div",{className:u,style:{overflow:"hidden",position:"relative",border:"2px solid transparent"},children:[(0,r.jsx)(L.A8,{src:n.content,children:(0,r.jsx)(A.default,{width:Math.min(.6*window.innerWidth,300),height:Math.min(.6*window.innerWidth,300),className:u,src:n.content,alt:"Image",style:{filter:c?"none":"blur(8px)",transition:"filter 0.3s ease-in-out",maxWidth:"100%",objectFit:"contain",backgroundColor:o.general.background[l]},sizes:"(max-width: 768px) 70vw, 400px"})},n.id),!c&&(0,r.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:o.message.imageOverlay.text[l],backgroundColor:o.message.imageOverlay.background[l],padding:"4px 8px",borderRadius:"0.25rem",pointerEvents:"none",fontSize:"0.85rem"},children:"(tap to reveal)"})]}),(0,r.jsx)(B,{message:n,user:t,theme:o,mode:l})]})}function W(e){let{message:t,user:n,theme:a,mode:s,isUserMessage:i,roundedCorners:o,isLargeEmojiMessage:l,onLinkClick:c}=e,d="deleted"===t.type,u=i?a.message.myMessage:a.message.strangerMessage;return(0,r.jsx)(r.Fragment,{children:l?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"px-2 py-2",children:[(0,r.jsx)("p",{className:"text-5xl",children:t.content}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(B,{message:t,user:n,theme:a,mode:s})})]})}):(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("div",{className:"".concat(o," animate-gradient-x"),style:{background:u.background[s],backgroundSize:"200% 100%",color:u.text[s]}}),(0,r.jsx)("div",{className:"".concat(o," relative max-w-full break-words px-3 py-2 ").concat(u.isAnimated?"bg-white opacity-70":""),style:{wordBreak:"break-word",overflowWrap:"break-word",color:u.text[s]},children:(0,r.jsx)("p",{className:"break-words whitespace-pre-wrap",children:(0,r.jsx)(E.A,{options:{render:e=>{let{attributes:t,content:n}=e;return(0,r.jsx)("a",{...t,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"underline",color:a.linkColor[s]},onClick:e=>{c?c(e):e.stopPropagation()},children:n})}},children:d?(0,r.jsx)("span",{className:"italic",style:{color:a.message.deletedMessage.text[s]},children:"Message has been deleted."}):t.content})})})]}),(0,r.jsx)(B,{message:t,user:n,theme:a,mode:s})]})})}function U(e){let{message:t,user:n,onSwipe:a,onReact:i,onStartedSwipe:o,onEndedSwipe:l,animate:c=!1,mode:d,theme:u,advertisementMessageId:g,onOpenEmojiMenu:m=()=>{},onResendMessage:h=()=>{},isEmojiMenuOpen:f,onLinkClick:x}=e,[b,p]=(0,s.useState)(!1),[y,k]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{k("ontouchstart"in window||navigator.maxTouchPoints>0)},[]),(0,r.jsx)("div",{"data-message-id":"message-"+t.id,className:"relative px-4 select-none",onMouseEnter:()=>!y&&p(!0),onMouseLeave:()=>!y&&p(!1),children:(0,r.jsx)("div",{children:(0,r.jsx)(O,{onLinkClick:x,animate:c,message:t,user:n,mode:d,hovered:b,reply:()=>a(t.id),onOpenEmojiMenu:()=>m(t),onReact:e=>i(t.id,e),onResendMessage:h,theme:u,advertisementMessageId:g},t.id+"-bubble")},"parent-message-bubble flex flex-col")})}let Y={name:"Default Green",typography:{fontFamily:"inherit",baseFontSize:"16px"},accent:{main:{light:"#16a34a",dark:"#16a34a"},faded:{light:"rgba(22, 163, 74, 0.1)",dark:"rgba(34, 197, 94, 0.1)"}},secondaryText:{light:"#6b7280",dark:"#9ca3af"},errorText:{light:"#b91c1c",dark:"#ef4444"},linkColor:{light:"#2563eb",dark:"#3b82f6"},announcement:{background:{light:"#ffffff",dark:"#1f2937"},text:{light:"#111827",dark:"#f9fafb"},border:{light:"rgba(229, 231, 235, 0.8)",dark:"rgba(55, 65, 81, 0.8)"}},animations:{typingIndicatorDots:{dark:"#f9fafb",light:"#111827"}},messageList:{scrollbarThumb:{light:"#9ca3af",dark:"#6b7280"},scrollbarTrack:{light:"#f3f4f6",dark:"#111827"}},overlays:{emojiMenu:{background:{light:"#f3f4f6",dark:"#1f2937"},shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},replyingPreview:{background:{light:"#f3f4f6",dark:"#1f2937"},border:{light:"#16a34a",dark:"#16a34a"},closeIcon:{light:"#6b7280",dark:"#9ca3af"},description:{light:"#111827",dark:"#f9fafb"},title:{light:"#111827",dark:"#f9fafb"}}},general:{background:{light:"#ffffff",dark:"#111827"},backdropBlur:"1.5rem",shadow:"0 25px 50px -12px rgb(0 0 0 / 0.25)",borderRadius:"2rem"},header:{background:{light:"rgba(255, 255, 255, 0.6)",dark:"rgba(29, 39, 53, 0.6)"},border:{light:"rgba(229, 231, 235, 0.8)",dark:"rgba(55, 65, 81, 0.8)"},statusLabel:{light:"#6b7280",dark:"#9ca3af"},statusValue:{light:"#16a34a",dark:"#16a34a"}},message:{myMessage:{background:{light:"#16a34a",dark:"#16a34a"},text:{light:"#ffffff",dark:"#ffffff"},isAnimated:!1},strangerMessage:{background:{light:"#f3f4f6",dark:"#374151"},text:{light:"#1f2937",dark:"#f9fafb"},isAnimated:!1},systemMessage:{background:{light:"#f3f4f6",dark:"#1f2937"},text:{light:"#6b7280",dark:"#9ca3af"}},deletedMessage:{text:{light:"#6b7280",dark:"#9ca3af"}},imageOverlay:{background:{light:"rgba(0, 0, 0, 0.4)",dark:"rgba(0, 0, 0, 0.4)"},text:{light:"#ffffff",dark:"#ffffff"}}},inputArea:{background:{light:"rgba(255, 255, 255, 0.6)",dark:"rgba(29, 39, 53, 0.6)"},border:{light:"rgba(229, 231, 235, 0.8)",dark:"rgba(55, 65, 81, 0.8)"},inputBackground:{light:"rgba(255, 255, 255, 0.8)",dark:"rgba(55, 65, 81, 0.5)"},inputText:{light:"#111827",dark:"#f9fafb"},placeholderText:{light:"#9ca3af",dark:"#6b7280"},focusRing:{light:"#16a34a",dark:"#16a34a"}},buttons:{primary:{background:{light:"#16a34a",dark:"#16a34a"},text:{light:"#ffffff",dark:"#ffffff"},hoverBackground:{light:"#15803d",dark:"#16a34a"}},secondary:{background:{light:"#fff",dark:"#374151"},text:{light:"#1f2937",dark:"#f9fafb"},hoverBackground:{light:"#d1d5db",dark:"#4b5563"},border:{light:"#d1d5db",dark:"#4b5563"}},destructive:{background:{light:"#dc2626",dark:"#ef4444"},text:{light:"#ffffff",dark:"#ffffff"},hoverBackground:{light:"#b91c1c",dark:"#dc2626"},border:{light:"#dc2626",dark:"#ef4444"}},newMessages:{background:{light:"#f59e0b",dark:"#fcd347"},text:{light:"#ffffff",dark:"#ffffff"},hoverBackground:{light:"#d97706",dark:"#f59e0b"}}},reactions:{bubble:{background:{light:"#f3f4f6",dark:"#374151"},border:{light:"#ffffff",dark:"#111827"},text:{light:"#111827",dark:"#f3f4f6"}}}},X={name:"Tyron's Theme",typography:{fontFamily:"inherit",baseFontSize:"16px"},accent:{main:{light:"#ee9ca7",dark:"#e18ea6"},faded:{light:"rgba(238, 156, 167, 0.15)",dark:"rgba(225, 142, 166, 0.15)"}},secondaryText:{light:"#a195a0",dark:"#b0a5af"},errorText:{light:"#f87171",dark:"#f87171"},linkColor:{light:"#9333ea",dark:"#c084fc"},announcement:{background:{light:"#fff9fb",dark:"#4c3b4d"},text:{light:"#5c4754",dark:"#fdecf2"},border:{light:"#fceaf2",dark:"#604d60"}},animations:{typingIndicatorDots:{dark:"#fdecf2",light:"#d66983"}},messageList:{scrollbarThumb:{light:"#fceaf2",dark:"#7c5c7a"},scrollbarTrack:{light:"#fff9fb",dark:"#302830"}},overlays:{emojiMenu:{background:{light:"#fff9fb",dark:"#302830"},shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},replyingPreview:{background:{light:"#fdecf2",dark:"#4c3b4d"},border:{light:"#ee9ca7",dark:"#e18ea6"},closeIcon:{light:"#a195a0",dark:"#b0a5af"},description:{light:"#5c4754",dark:"#fdecf2"},title:{light:"#d66983",dark:"#ee9ca7"}}},general:{background:{light:"#fffbff",dark:"#302830"},backdropBlur:"1.5rem",shadow:"0 25px 50px -12px rgb(0 0 0 / 0.25)",borderRadius:"2rem"},header:{background:{light:"rgba(255, 249, 251, 0.6)",dark:"rgba(48, 40, 48, 0.6)"},border:{light:"rgba(253, 236, 242, 0.8)",dark:"rgba(76, 59, 77, 0.8)"},statusLabel:{light:"#a195a0",dark:"#b0a5af"},statusValue:{light:"#d66983",dark:"#ee9ca7"}},message:{myMessage:{background:{light:"#ee9ca7",dark:"#e18ea6"},text:{light:"#ffffff",dark:"#ffffff"},isAnimated:!1},strangerMessage:{background:{light:"#fdecf2",dark:"#4c3b4d"},text:{light:"#5c4754",dark:"#fdecf2"},isAnimated:!1},systemMessage:{background:{light:"#fdecf2",dark:"#4c3b4d"},text:{light:"#a195a0",dark:"#b0a5af"}},deletedMessage:{text:{light:"#a195a0",dark:"#b0a5af"}},imageOverlay:{background:{light:"rgba(0, 0, 0, 0.4)",dark:"rgba(0, 0, 0, 0.4)"},text:{light:"#ffffff",dark:"#ffffff"}}},inputArea:{background:{light:"rgba(255, 249, 251, 0.6)",dark:"rgba(48, 40, 48, 0.6)"},border:{light:"rgba(253, 236, 242, 0.8)",dark:"rgba(76, 59, 77, 0.8)"},inputBackground:{light:"#fffbff",dark:"rgba(76, 59, 77, 0.5)"},inputText:{light:"#5c4754",dark:"#ee9ca7"},placeholderText:{light:"#a195a0",dark:"#7c5c7a"},focusRing:{light:"#ee9ca7",dark:"#e18ea6"}},buttons:{primary:{background:{light:"#ee9ca7",dark:"#e18ea6"},text:{light:"#ffffff",dark:"#ffffff"},hoverBackground:{light:"#e18ea6",dark:"#d66983"}},secondary:{background:{light:"#fffbff",dark:"#4c3b4d"},text:{light:"#d66983",dark:"#ee9ca7"},hoverBackground:{light:"#fdecf2",dark:"#604d60"},border:{light:"#fceaf2",dark:"#604d60"}},destructive:{background:{light:"#fca5a5",dark:"#ef4444"},text:{light:"#7f1d1d",dark:"#ffffff"},hoverBackground:{light:"#f87171",dark:"#dc2626"},border:{light:"#fca5a5",dark:"#ef4444"}},newMessages:{background:{light:"#fb923c",dark:"#fdba74"},text:{light:"#ffffff",dark:"#431407"},hoverBackground:{light:"#f97316",dark:"#fb923c"}}},reactions:{bubble:{background:{light:"#fdecf2",dark:"#604d60"},border:{light:"#fffbff",dark:"#302830"},text:{light:"#d66983",dark:"#ee9ca7"}}}};function H(e){let{index:t,message:n,user:a,animate:s=!1,isLast:i=!1,onSwipe:o,onStartedSwipe:l,onEndedSwipe:c,onReact:d,onOpenEmojiMenu:u,onResendMessage:g,isEmojiMenuOpen:m,theme:h=Y,mode:f,secondVisibleElement:x,onLinkClick:b}=e;if("system"===n.sender)return(0,r.jsx)("div",{className:"flex justify-center py-4 px-4 text-center",children:(0,r.jsx)("p",{className:"text-xs text-gray-500",children:n.content})},n.id+"_system");let p=t%5==0?n.id:null;return(0,r.jsxs)("div",{"data-is-message":"true","data-message-id":n.id,className:"max-w-full w-full select-none",children:[n.showTime&&(0,r.jsx)("div",{className:"flex justify-center py-4",children:(0,r.jsx)("p",{className:"text-xs font-normal",style:{color:h.message.systemMessage.text[f]},children:n.created_at&&(0,S.GP)(new Date(n.created_at),"h:mm a")})},n.id+"_time"),(0,r.jsx)(U,{advertisementMessageId:p,message:n,animate:s,user:a,onSwipe:o,onStartedSwipe:l,onEndedSwipe:c,onReact:d,onOpenEmojiMenu:u,onResendMessage:g,theme:h,mode:f,isEmojiMenuOpen:m,onLinkClick:b},n.id+"_message"),(i||!n.hasNext)&&(0,r.jsx)("div",{className:"h-1"},n.id+"_bottom")]},"parent_message_"+n.id)}let J={name:"\uD83D\uDC1D Theme",typography:{fontFamily:"inherit",baseFontSize:"16px"},accent:{main:{light:"#FFCB37",dark:"#FFD966"},faded:{light:"rgba(255, 203, 55, 0.15)",dark:"rgba(255, 217, 102, 0.15)"}},secondaryText:{light:"#707070",dark:"#A0A0A0"},errorText:{light:"#D9534F",dark:"#f87171"},linkColor:{light:"#FFCB37",dark:"#FFD966"},announcement:{background:{light:"#FFFBEB",dark:"#3A301A"},text:{light:"#282828",dark:"#FFFBEB"},border:{light:"#FEEBC8",dark:"#4A3C22"}},animations:{typingIndicatorDots:{dark:"#FFFBEB",light:"#333333"}},messageList:{scrollbarThumb:{light:"#FFD966",dark:"#5A4C29"},scrollbarTrack:{light:"#FFFBEB",dark:"#1E1E1E"}},overlays:{emojiMenu:{background:{light:"#FFFFFF",dark:"#1E1E1E"},shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},replyingPreview:{background:{light:"#F0F0F0",dark:"#2C2C2C"},border:{light:"#FFCB37",dark:"#FFD966"},closeIcon:{light:"#707070",dark:"#A0A0A0"},description:{light:"#333333",dark:"#F0F0F0"},title:{light:"#222222",dark:"#FFFFFF"}}},general:{background:{light:"#FFFFFF",dark:"#121212"},backdropBlur:"1.5rem",shadow:"0 25px 50px -12px rgb(0 0 0 / 0.25)",borderRadius:"2rem"},header:{background:{light:"rgba(255, 255, 255, 0.8)",dark:"rgba(30, 30, 30, 0.8)"},border:{light:"rgba(240, 240, 240, 0.8)",dark:"rgba(44, 44, 44, 0.8)"},statusLabel:{light:"#707070",dark:"#A0A0A0"},statusValue:{light:"#333333",dark:"#FFD966"}},message:{myMessage:{background:{light:"#FFCB37",dark:"#FFD966"},text:{light:"#222222",dark:"#222222"},isAnimated:!1},strangerMessage:{background:{light:"#F0F0F0",dark:"#2C2C2C"},text:{light:"#222222",dark:"#FFFFFF"},isAnimated:!1},systemMessage:{background:{light:"#F0F0F0",dark:"#2C2C2C"},text:{light:"#707070",dark:"#A0A0A0"}},deletedMessage:{text:{light:"#A0A0A0",dark:"#707070"}},imageOverlay:{background:{light:"rgba(0, 0, 0, 0.4)",dark:"rgba(0, 0, 0, 0.4)"},text:{light:"#ffffff",dark:"#ffffff"}}},inputArea:{background:{light:"rgba(255, 255, 255, 0.8)",dark:"rgba(30, 30, 30, 0.8)"},border:{light:"rgba(240, 240, 240, 0.8)",dark:"rgba(44, 44, 44, 0.8)"},inputBackground:{light:"#FFFFFF",dark:"#2C2C2C"},inputText:{light:"#222222",dark:"#FFFFFF"},placeholderText:{light:"#A0A0A0",dark:"#707070"},focusRing:{light:"#FFD966",dark:"#FFCB37"}},buttons:{primary:{background:{light:"#FFCB37",dark:"#FFD966"},text:{light:"#222222",dark:"#222222"},hoverBackground:{light:"#FFD966",dark:"#FFCB37"}},secondary:{background:{light:"#FFFFFF",dark:"#2C2C2C"},text:{light:"#222222",dark:"#FFFFFF"},hoverBackground:{light:"#F0F0F0",dark:"#3C3C3C"},border:{light:"#F0F0F0",dark:"#3C3C3C"}},destructive:{background:{light:"#D9534F",dark:"#D9534F"},text:{light:"#FFFFFF",dark:"#FFFFFF"},hoverBackground:{light:"#C9302C",dark:"#C9302C"},border:{light:"#D43F3A",dark:"#D43F3A"}},newMessages:{background:{light:"#FFCB37",dark:"#FFD966"},text:{light:"#222222",dark:"#222222"},hoverBackground:{light:"#FFD966",dark:"#FFCB37"}}},reactions:{bubble:{background:{light:"#F0F0F0",dark:"#3C3C3C"},border:{light:"#FFFFFF",dark:"#121212"},text:{light:"#222222",dark:"#FFFFFF"}}}},V=["❤️","\uD83D\uDE06","\uD83D\uDE2E","\uD83D\uDE22","\uD83D\uDE2D","\uD83D\uDE21","\uD83D\uDC4D"];function q(e){let{isUserMessage:t,preselectedEmoji:n,message:a,messageDiv:i,onReact:o,onClose:l}=e,c=(0,s.useRef)(null),[d,u]=(0,s.useState)({top:0,left:0}),[g,m]=(0,s.useState)(null),h=(0,s.useRef)(null);return(0,s.useLayoutEffect)(()=>{let e=i.querySelector("#message-bubble");if(e.style.position="relative",e.style.zIndex="30",e&&c.current){let t=e.getBoundingClientRect(),n=c.current,r=n.offsetHeight,a=t.top+window.scrollY-r-10,s=t.right-n.offsetWidth-16;e.classList.contains("items-end")||(s=t.left-16),u({top:a,left:s})}return()=>{e.style.zIndex="0"}},[i]),(0,s.useEffect)(()=>{let e=c.current;if(!e)return;let t=t=>{if(0!==t.button)return;try{e.setPointerCapture(t.pointerId)}catch(e){}h.current=t.pointerId;let n=document.elementFromPoint(t.clientX,t.clientY);if(n){let e=n.closest("[data-emoji]");if(e)return void m(e.getAttribute("data-emoji"))}m(null)},r=t=>{if(h.current!==t.pointerId||!e)return;let n=document.elementFromPoint(t.clientX,t.clientY);if(n){let e=n.closest("[data-emoji]");if(e)return void m(e.getAttribute("data-emoji"))}m(null)},s=t=>{if(h.current===t.pointerId){if(g){let e=(null==n?void 0:n.emoji)===g?null:g;o(a.id,e)}l();try{e.releasePointerCapture(t.pointerId)}catch(e){}h.current=null}};return e.addEventListener("pointerdown",t),window.addEventListener("pointermove",r),window.addEventListener("pointerup",s),()=>{e.removeEventListener("pointerdown",t),window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",s)}},[g,o,l,n,a.id]),(0,r.jsx)(b.P.div,{layout:!0,className:"absolute top-0 left-0 w-screen h-screen",initial:{userSelect:"none",zIndex:100,opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,r.jsx)("div",{id:"emoji-abs-container",className:"absolute border-box flex z-50 w-full md:w-fit px-4",style:{position:"absolute",top:d.top,left:d.left},children:(0,r.jsx)(b.P.div,{ref:c,id:"emoji-container-wrapper",className:"w-full backdrop-blur-md bg-gray-100 py-2 px-5 dark:bg-gray-800/80 shadow-lg rounded-full border border-gray-200 dark:border-gray-700",initial:{scale:.8,opacity:0,y:10},animate:{scale:1,opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:20}},exit:{scale:.8,opacity:0,y:10,transition:{duration:.15}},children:(0,r.jsx)("div",{id:"emoji-container",className:"flex justify-between",children:(0,r.jsx)(p.N,{children:V.map(e=>(0,r.jsxs)(b.P.div,{className:"relative z-10 cursor-pointer rounded-full p-2 ".concat((null==n?void 0:n.emoji)===e?"bg-gray-200/80 dark:bg-gray-700/80":g===e?"bg-gray-100/80 dark:bg-gray-600/80":""),"data-emoji":e,animate:{scale:g===e?1.6:1},transition:{type:"spring",stiffness:300,damping:20},children:[(0,r.jsx)("span",{className:"text-xl",children:e}),(null==n?void 0:n.emoji)===e&&(0,r.jsx)(b.P.div,{className:"absolute -bottom-0.5 left-1/2 w-1 h-1 bg-green-500 rounded-full",initial:{opacity:0},animate:{opacity:1},layoutId:"selectedDot",style:{translateX:"-50%"}})]},e))})})})})},"emoji-menu")}var G=n(4357),Z=n(3717),Q=n(4126);function K(e){let{theme:t,anchor:n,onReply:a,onCopy:i,onEdit:o,onClose:l,onDelete:c}=e,d=n.querySelector("#message-bubble"),u=d.classList.contains("items-end"),g=null!==d.querySelector("#image-message-container"),m=[{icon:(0,r.jsx)(I.A,{className:"h-4 w-4"}),text:"Reply",onClick:a},{icon:(0,r.jsx)(G.A,{className:"h-4 w-4"}),text:"Copy",onClick:i},...u&&!g?[{icon:(0,r.jsx)(Z.A,{className:"h-4 w-4"}),text:"Edit",onClick:o}]:[],...u?[{icon:(0,r.jsx)(Q.A,{className:"h-4 w-4"}),text:"Delete",onClick:c}]:[]],[h,f]=(0,s.useState)({top:0,left:0}),[x,p]=(0,s.useState)(null),y=(0,s.useRef)(null),k=(0,s.createRef)();return(0,s.useEffect)(()=>{y.current=x},[x]),(0,s.useLayoutEffect)(()=>{if(!n||!k.current)return;let e=n.querySelector("#message-bubble"),t=document.querySelector("#chat-container"),r=e.getBoundingClientRect(),a=k.current.getBoundingClientRect(),s=r.bottom+10;if(s+a.height>t.clientHeight/2){s=r.top-a.height-10;let e=document.querySelector("#emoji-abs-container");e&&(e.style.top="".concat(s-a.height,"px"),s-=e.offsetHeight+24)}s+=window.scrollY;let i=r.right-a.width-24;u||(i=r.left),f({top:s,left:i})},[n,u]),(0,s.useEffect)(()=>{let e=e=>{if(!k.current)return;let t=k.current.querySelectorAll("button"),n=null;t.forEach((t,r)=>{let a=t.getBoundingClientRect();e.clientX>=a.left&&e.clientX<=a.right&&e.clientY>=a.top&&e.clientY<=a.bottom&&(n=r)}),p(n)},t=e=>{if(null!==y.current&&k.current){let e=k.current.querySelectorAll("button")[y.current];e&&e.click()}};window.addEventListener("pointermove",e),window.addEventListener("pointerup",t);let n=new PointerEvent("pointerdown",{bubbles:!0});return window.dispatchEvent(n),()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",t)}},[]),(0,r.jsx)(b.P.div,{ref:k,id:"context-menu",className:"absolute flex flex-col rounded-3xl w-[200px] overflow-clip",style:{background:(null==t?void 0:t.chatBackground)||"linear-gradient(180deg, #ffffff, #ffffff)",top:h.top,left:h.left},initial:{opacity:0,scale:.9,transition:{type:"spring",stiffness:300,damping:20}},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9,transition:{duration:.15}},children:m.map((e,t)=>(0,r.jsx)($,{icon:e.icon,text:e.text,onClick:()=>{e.onClick(),l()},active:x===t},t))})}function $(e){let{icon:t,text:n,onClick:a,active:s}=e;return(0,r.jsx)("div",{children:(0,r.jsxs)("button",{onClick:a,className:"flex items-center justify-start w-full px-6 py-4 text-sm text-black hover:bg-gray-200 ".concat(s?"bg-gray-200":""),children:[(0,r.jsx)("p",{className:"mr-auto",children:n}),t]})})}let ee={id:"default",name:"Default Chat Theme",accentColor:"#16a34a",userBubbleGradient:"linear-gradient(90deg, #16a34a, #16a34a)",userTextColor:"#ffffff",otherBubbleGradient:"linear-gradient(90deg, #f3f4f6, #f3f4f6)",otherTextColor:"#1F2937",otherAnimated:!1,userAnimated:!1,chatBackground:"linear-gradient(180deg, #ffffff, #ffffff)"},et=e=>{var t,n,a,s;let{open:i,message:o,messageDiv:l,user:c,onReact:d,onClose:u,onCopy:g,onEdit:m,onReply:h,onDelete:f}=e;return(0,r.jsx)(p.N,{children:i&&(0,r.jsxs)("div",{id:"emoji-overlay-main",className:"overflow-visible absolute left-0 top-0 select-none",children:[(0,r.jsx)(b.P.div,{layout:!0,initial:{opacity:0},animate:{opacity:.5},exit:{opacity:0},className:"fixed inset-0 bg-black z-30",onClick:u},"emoji-overlay"),(0,r.jsxs)("div",{className:"relative z-40 w-full",children:[(0,r.jsx)(q,{isUserMessage:o.sender===c.id,preselectedEmoji:(null==(n=o.reactions)||null==(t=n.find(e=>e.user_id===c.id))?void 0:t.emoji)!=null?{emoji:null==(s=o.reactions)||null==(a=s.find(e=>e.user_id===c.id))?void 0:a.emoji}:void 0,messageDiv:l,message:o,onReact:d,onClose:u},"emoji-menu"),(0,r.jsx)(K,{onCopy:()=>g(o.id),onEdit:()=>m(o.id),onReply:()=>h(o.id),onDelete:()=>f(o.id),onClose:u,theme:ee,anchor:l},"context-menu")]},"context-container")]},"emoji-overlay-main")})};var en=n(4304);let er=e=>{let{theme:t,mode:n}=e,a={backgroundColor:t.message.strangerMessage.background[n]},s={backgroundColor:t.animations.typingIndicatorDots[n]};return(0,r.jsx)(b.P.div,{className:"flex justify-start",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:(0,r.jsxs)("div",{className:"flex mb-2 mx-4 max-w-[100%] rounded-3xl px-4 py-4 relative",style:a,children:[(0,r.jsx)("div",{className:"h-2 w-2 rounded-full animate-bounce [animation-delay:-0.3s]",style:s}),(0,r.jsx)("div",{className:"h-2 w-2 mx-1 rounded-full animate-bounce [animation-delay:-0.15s]",style:s}),(0,r.jsx)("div",{className:"h-2 w-2 rounded-full animate-bounce",style:s})]})},"typing-motiondiv")},ea=(e,t)=>Math.random()*(t-e)+e,es=e=>{let{a:t,d:n,color:a}=e,s=Math.cos(t)*n,i=Math.sin(t)*n,o=ea(2,4),l=ea(0,2),c=ea(.8,1.2);return(0,r.jsx)(b.P.div,{className:"absolute rounded-full",style:{width:10,height:10,left:"50%",top:"50%",translateX:"-50%",translateY:"-50%",backgroundColor:a},initial:{x:0,y:0,scale:0},animate:{x:s,y:i,scale:c},transition:{duration:o,delay:l,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}})},ei=e=>{var t;let{theme:n,mode:a,onCancel:s}=e,i=Array.from({length:5}).map((e,t)=>({id:t,angle:t/5*2*Math.PI,distance:ea(80,120)})),o=n.buttons.primary.text[a],l=n.accent.main[a],c=n.general.background[a],d={initial:{scale:0,opacity:.5},animate:e=>({scale:1,opacity:0,transition:{delay:.7*e,duration:2.1,repeat:1/0,ease:"circOut"}})};return(0,r.jsxs)(b.P.div,{className:"absolute inset-0 flex flex-col items-center justify-center w-full h-full overflow-hidden z-10",style:{backgroundColor:l},variants:{hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1,transition:{duration:.4,ease:"easeOut"}},exit:{opacity:0,scale:.95,transition:{duration:.3,ease:"easeIn"}}},initial:"hidden",animate:"visible",exit:"exit",children:[(0,r.jsxs)("div",{className:"relative w-64 h-64 flex items-center justify-center",children:[(0,r.jsx)(p.N,{children:[0,1,2].map(e=>(0,r.jsx)(b.P.div,{className:"absolute w-full h-full rounded-full border-2",style:{borderColor:o},variants:d,initial:"initial",animate:"animate",custom:e},e))}),(0,r.jsx)(b.P.div,{className:"relative w-24 h-24 rounded-full flex items-center justify-center shadow-lg",style:{backgroundColor:c},animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:(0,r.jsx)("svg",{className:"w-12 h-12",style:{color:l},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8s-9-3.582-9-8 4.03-8 9-8 9 3.582 9 8z"})})}),(0,r.jsx)("div",{className:"absolute w-full h-full",children:i.map(e=>(0,r.jsx)(es,{a:e.angle,d:e.distance,color:o},e.id))})]}),(0,r.jsx)(b.P.p,{className:"mt-8 text-2xl font-semibold tracking-wider",style:{color:o},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.5,ease:"easeOut"},children:"Finding a match..."}),(0,r.jsx)(b.P.button,{className:"mt-6 px-6 py-2 rounded-full text-sm font-semibold transition-colors",style:{backgroundColor:n.buttons.secondary.background[a],color:n.buttons.secondary.text[a],...(null==(t=n.buttons.secondary.border)?void 0:t[a])?{border:"1px solid ".concat(n.buttons.secondary.border[a])}:{border:"none"},opacity:.8},onClick:s,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.7,ease:"easeOut"},whileHover:{scale:1.05,opacity:1},whileTap:{scale:.95},children:"Cancel"})]})},eo=(0,s.createContext)(void 0),el=e=>{let{children:t}=e,[n,a]=(0,s.useState)(Y),[i,o]=(0,s.useState)("light"),l=(0,s.useMemo)(()=>({theme:n,mode:i,setMode:o,setTheme:a}),[n,i]);return(0,r.jsx)(eo.Provider,{value:l,children:t})},ec=()=>{let e=(0,s.useContext)(eo);if(void 0===e)throw Error("useChatTheme must be used within a ChatThemeProvider");return e};var ed=n(3127);let eu=e=>{let{theme:t,mode:n}=e,a=(0,s.useRef)(!1),i={id:"me"},o=[{id:"1",content:"Preview message!",sender:"stranger",created_at:new Date().toISOString(),session_id:"1",hasNext:!0},{id:"3",content:"I can't think of anything to put here",sender:"stranger",created_at:new Date().toISOString(),session_id:"1",hasPrevious:!0},{id:"2",content:"This looks great.",sender:"me",created_at:new Date().toISOString(),session_id:"1",hasNext:!0},{id:"8",content:"LOL! just type anything",sender:"me",created_at:new Date().toISOString(),session_id:"1",hasPrevious:!0,reactions:[{emoji:"\uD83D\uDE06",user_id:"1",message_id:"8"}]}],l=(e,s)=>"system"===e.sender||"system"===e.type?(0,r.jsx)("div",{className:"text-center my-2 mx-4",children:(0,r.jsx)("span",{style:{color:t.message.systemMessage.text[n],backgroundColor:t.message.systemMessage.background[n]},className:" box-decoration-clone  text-xs rounded-full px-3 py-1 leading-relaxed       ",children:e.content})},s):(0,r.jsx)(v,{children:(0,r.jsx)(H,{index:s,message:e,user:i,isLast:0===s,onSwipe:()=>{},onStartedSwipe:()=>{},onEndedSwipe:()=>{},onReact:async()=>{},onOpenEmojiMenu:()=>{},onResendMessage:()=>{},isEmojiMenuOpen:a,theme:t,mode:n,animate:!0,secondVisibleElement:null},s)},e.id+"listener");return(0,r.jsx)("div",{className:"w-full p-4 rounded-lg flex flex-col",style:{backgroundColor:t.general.background[n]},children:(0,r.jsx)("div",{className:"flex flex-col",children:o.map((e,t)=>(0,r.jsx)("div",{className:"w-full",children:l(e,t)},e.id))})})};function eg(e){let{isOpen:t,onClose:n,themes:a,activeTheme:i,setActiveThemeAndMode:o,activeMode:l}=e,[c,d]=(0,s.useState)(i),[u,g]=(0,s.useState)(l);(0,s.useEffect)(()=>{d(i),g(l)},[t,i,l]);let m=()=>{d(i),g(l),n()};return(0,r.jsx)(p.N,{children:t&&(0,r.jsx)(b.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-start justify-center z-50 p-4 pt-12 overflow-y-auto",onClick:m,children:(0,r.jsxs)(b.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:20,stiffness:300},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-2xl",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("div",{className:"p-5 border-b dark:border-gray-700",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:"Choose Theme"})}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6 p-5",children:[(0,r.jsxs)("div",{className:"flex flex-col space-y-6",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("select",{value:c.name,onChange:e=>{let t=a.find(t=>t.name===e.target.value);t&&d(t)},style:{backgroundColor:c.accent.faded[u]},className:"w-full px-4 py-2.5 rounded-lg border appearance-none transition-colors duration-300 focus:outline-none focus:ring-2",children:a.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.name))}),(0,r.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2",style:{color:c.secondaryText[u]},children:(0,r.jsx)("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-3 text-gray-700 dark:text-gray-300",children:"Mode"}),(0,r.jsxs)("div",{className:"flex items-center justify-between bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[(0,r.jsx)("button",{onClick:()=>g("light"),className:"w-1/2 py-2 rounded-md text-sm font-semibold transition-colors ".concat("light"===u?"bg-white dark:bg-gray-500 text-gray-800 dark:text-white shadow":"text-gray-500 dark:text-gray-400"),children:"Light"}),(0,r.jsx)("button",{onClick:()=>g("dark"),className:"w-1/2 py-2 rounded-md text-sm font-semibold transition-colors ".concat("dark"===u?"bg-black text-white shadow":"text-gray-500 dark:text-gray-400"),children:"Dark"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-3 text-gray-700 dark:text-gray-300",children:"Preview"}),(0,r.jsx)("div",{className:"bg-gray-200 dark:bg-gray-900 rounded-xl overflow-hidden shadow-inner",children:(0,r.jsx)(eu,{theme:c,mode:u})})]})]}),(0,r.jsxs)("div",{className:"p-5 border-t dark:border-gray-700 flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:m,className:"px-4 py-2 text-sm font-semibold bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>{o(c,u),n()},className:"px-4 py-2 text-sm font-semibold bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Save Changes"})]})]})})})}let em=e=>{let{theme:t,mode:n}=e;return(0,r.jsx)("style",{children:"\n    #chat-messages-list::-webkit-scrollbar {\n      width: 8px;\n    }\n    #chat-messages-list::-webkit-scrollbar-track {\n      background: ".concat(t.messageList.scrollbarTrack[n],";\n    }\n    #chat-messages-list::-webkit-scrollbar-thumb {\n      background-color: ").concat(t.messageList.scrollbarThumb[n],";\n      border-radius: 4px;\n    }\n    #chat-messages-list::-webkit-scrollbar-thumb:hover {\n      background-color: ").concat(t.buttons.primary.hoverBackground[n],";\n    }\n    #chat-input:focus {\n      outline: none;\n      box-shadow: 0 0 0 2px ").concat(t.inputArea.focusRing[n],";\n    }\n    #send-button:hover {\n        background-color: ").concat(t.buttons.primary.hoverBackground[n]," !important;\n    }\n    #new-messages-button:hover {\n        background-color: ").concat(t.buttons.newMessages.hoverBackground[n]," !important;\n    }\n  ")})};function eh(e){var t,n,a,i,o;let{messages:l,goBack:c,sendMessage:d,onStartTyping:u,cancelMatchmaking:m=()=>{},onEditMessage:h,isStrangerTyping:f,onChangeTheme:y,endChat:k,newChat:j,onReact:w,peerId:N,status:C}=e,F={id:N},{theme:S,mode:E}=ec(),[T,_]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=async()=>{let{data:e,error:t}=await x.from("announcements").select("*").order("created_at",{ascending:!1}).limit(1).single();if(t)return void console.error("Error fetching announcement:",t);(null==e?void 0:e.content)&&_(e.content)},t=x.channel("public:announcements");return t.on("postgres_changes",{event:"*",schema:"public",table:"announcements"},e=>{e.new&&_(e.new.content||null)}).subscribe(),e(),()=>{x.removeChannel(t)}},[]);let I=function(e){let[t,n]=(0,s.useState)([]);return(0,s.useEffect)(()=>{if(!e||0===e.length)return void n([]);let t=null,r=[];for(let n=0;n<e.length;n++){let a=e[n],s=new Date(a.created_at).getTime(),i=!1;isNaN(s)?console.warn("Invalid date encountered for message:",a.id):"system"!==a.sender&&"typing"!==a.id&&"filler"!==a.id&&(null===t||s-t>3e5)&&(i=!0,t=s),r.push({...a,showTime:i,hasPrevious:!1,hasNext:!1})}r=r.map(e=>{let t=e.replyingTo;if(t&&"string"==typeof t){let n=r.find(e=>e.id===t);if(n)return{...e,replyingTo:n}}return e});for(let e=0;e<r.length;e++){let t=r[e],n=r[e-1],a=r[e+1];if(!t)continue;t.hasPrevious=!!n&&n.sender===t.sender,t.hasNext=!!a&&a.sender===t.sender,t.showTime&&n&&(t.hasPrevious=!1,n.hasNext=!1),t.reactions&&t.reactions.length>0&&a&&(t.hasNext=!1,a.sender===t.sender&&(a.hasPrevious=!1)),t.replyingTo&&n&&(t.hasPrevious=!1,n.sender===t.sender&&(n.hasNext=!1)),t.replyingTo&&a&&(t.hasNext=!1,a.sender===t.sender&&(a.hasPrevious=!1)),n&&n.replyingTo&&(t.hasPrevious=!1,n.hasNext=!1);let s=r[e+1];s&&("system"===s.sender||"typing"===s.id||"filler"===s.id)&&(t.hasNext=!1)}let a=null,s=r.findIndex(e=>"typing"===e.id);-1!==s&&(a=r.splice(s,1)[0]);let i=new Set,o=r.filter(e=>!i.has(e.id)&&(i.add(e.id),!0));a&&o.push(a),n(o)},[e]),t}(l),M=(0,s.useRef)(null),[P,A]=(0,s.useState)(!1),D=(0,s.useRef)(I.length),[R,B]=(0,s.useState)(!1),L=(0,s.useRef)(!0),[O,z]=(0,s.useState)(""),[W,U]=(0,s.useState)(!1),V=(0,s.useRef)(!1),[q,G]=(0,s.useState)({open:!1}),[Z,Q]=(0,s.useState)(null),K=e=>{if(!e)return void G({open:!1});let t=document.querySelector('[data-message-id="'.concat(null==e?void 0:e.id,'"]'));t&&G({open:!0,message:e,messageDiv:t})};(0,s.useEffect)(()=>{if(0===I.length)return;let e=I.length>D.current,t=I[I.length-1];if("typing"===t.id){D.current=I.length;return}if(e)if(t.sender===F.id||L.current){var n;null==(n=M.current)||n.scrollToIndex(I.length-1,{align:"end",smooth:!0})}else B(!0);D.current=I.length},[I,F.id]),(0,s.useEffect)(()=>{if(L.current&&f){var e;null==(e=M.current)||e.scrollToIndex(I.length)}},[f]),(0,s.useEffect)(()=>{let e=document.querySelector("#chat-messages-list");e&&(e.style.overflow=P||q.open?"hidden":"auto")},[P,q]);let $=(e,t)=>"system"===e.sender||"system"===e.type?(0,r.jsx)("div",{className:"text-center my-2 mx-4",children:(0,r.jsx)("span",{style:{color:S.message.systemMessage.text[E],backgroundColor:S.message.systemMessage.background[E]},className:" box-decoration-clone  text-xs rounded-full px-3 py-1 leading-relaxed       ",children:e.content})},t):(0,r.jsx)(v,{children:(0,r.jsx)(H,{index:t,message:e,user:F,isLast:0===t,onSwipe:e=>{let t=l.find(t=>t.id===e);t&&Q({message:t,type:"replying",title:"Replying",description:t.content})},onStartedSwipe:()=>{},onEndedSwipe:()=>{},onReact:w,onOpenEmojiMenu:()=>K(e),onResendMessage:()=>{},isEmojiMenuOpen:V,theme:S,mode:E,animate:!0,secondVisibleElement:null},t)},e.id+"listener"),[ee,ea]=(0,s.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(em,{theme:S,mode:E}),(0,r.jsx)(eg,{isOpen:ee,onClose:()=>ea(!1),themes:[Y,X,J],activeTheme:S,setActiveThemeAndMode:(e,t)=>{null==y||y(t,e)},activeMode:E}),(0,r.jsx)(et,{open:q.open,message:q.message,messageDiv:q.messageDiv,user:F,onReact:w,onReply:e=>{let t=l.find(t=>t.id===e);t&&Q({message:t,type:"replying",title:"Replying",description:t.content})},onEdit:e=>{let t=l.find(t=>t.id===e);t&&(z(t.content),Q({message:t,type:"editing",title:"Editing",description:t.content}))},onCopy:e=>{let t=l.find(t=>t.id===e);t&&(navigator.clipboard.writeText(t.content),K(null))},onDelete:e=>{console.log("Delete message with ID: ".concat(e)),K(null)},onClose:()=>K(null)}),(0,r.jsxs)("div",{id:"chat-container",style:{fontFamily:S.typography.fontFamily,fontSize:S.typography.baseFontSize,backgroundColor:S.general.background[E],backdropFilter:"blur(".concat(S.general.backdropBlur,")"),boxShadow:S.general.shadow,borderRadius:"var(--chat-border-radius, 2rem)"},className:"w-full max-w-md mx-auto h-[100dvh] flex flex-col overflow-hidden",children:[(0,r.jsxs)("div",{style:{backgroundColor:S.header.background[E],borderColor:S.header.border[E]},className:"p-4 border-b flex items-center shrink-0",children:["connected"!==C&&(0,r.jsx)(g,{onClick:c,className:"rounded-full mr-2 p-1",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("polyline",{points:"15 18 9 12 15 6"})})}),(0,r.jsxs)("div",{className:"text-left mr-auto ml-2",children:[(0,r.jsx)("p",{style:{color:S.header.statusLabel[E]},className:"text-xs font-medium",children:"Status"}),(0,r.jsx)("p",{style:{color:S.header.statusValue[E]},className:"text-sm font-semibold",children:C.charAt(0).toUpperCase()+C.slice(1)})]}),(0,r.jsx)(g,{onClick:()=>ea(!0),variant:"outline",className:"mr-2 rounded-full",style:{backgroundColor:S.buttons.secondary.background[E],color:S.buttons.secondary.text[E],borderColor:(null==(t=S.buttons.secondary.border)?void 0:t[E])||"transparent"},children:(0,r.jsx)(ed.A,{})}),"connected"===C&&(0,r.jsx)(g,{onClick:()=>W?(k(),U(!1)):U(!0),className:"px-3 py-1 text-sm rounded-full",style:{backgroundColor:W?S.buttons.destructive.background[E]:S.buttons.secondary.background[E],color:W?S.buttons.destructive.text[E]:S.buttons.secondary.text[E],...(W?null==(n=S.buttons.destructive.border)?void 0:n[E]:null==(a=S.buttons.secondary.border)?void 0:a[E])?{border:"1px solid ".concat(W?null==(i=S.buttons.destructive.border)?void 0:i[E]:null==(o=S.buttons.secondary.border)?void 0:o[E])}:{}},children:W?"Confirm?":"End Chat"}),"connected"!==C&&(0,r.jsx)("button",{onClick:j,className:"px-3 py-1 text-sm rounded-full",style:{backgroundColor:S.buttons.primary.background[E],color:S.buttons.primary.text[E]},children:"New Chat"})]}),T&&(0,r.jsx)("div",{style:{backgroundColor:S.announcement.background[E],color:S.announcement.text[E],borderColor:S.announcement.border[E]},className:"p-2 text-center text-xs border-b shrink-0",children:(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:T}})}),(0,r.jsx)(p.N,{children:("waiting_for_match"===C||"finding_match"===C||"connecting"===C)&&(0,r.jsx)(ei,{onCancel:m,theme:S,mode:E},"finding-match-animation")}),(0,r.jsxs)("div",{className:"max-h-full h-full relative",children:[(0,r.jsxs)(en.x8,{ref:M,style:{overflowX:"hidden"},id:"chat-messages-list",onScroll:e=>{M.current&&(L.current=e-M.current.scrollSize+M.current.viewportSize>=-100,L.current&&B(!1))},reverse:!0,children:[I.map((e,t)=>$(e,t)),(0,r.jsx)(v,{children:f&&(0,r.jsx)(er,{theme:S,mode:E},"typing-indicator")})]}),(0,r.jsx)(p.N,{children:R&&(0,r.jsx)(b.P.div,{initial:{y:"100%"},animate:{y:"0"},exit:{y:"100%"},className:"absolute bottom-0 left-0 w-full flex items-center justify-center pb-24 pt-4",children:(0,r.jsxs)("button",{id:"new-messages-button",onClick:()=>{var e;null==(e=M.current)||e.scrollToIndex(I.length-1,{align:"end",smooth:!0}),B(!1)},style:{backgroundColor:S.buttons.newMessages.background[E],color:S.buttons.newMessages.text[E]},className:"px-4 py-2 rounded-full shadow-md flex items-center gap-2 transition-colors",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),"New messages"]})})})]}),Z&&(0,r.jsx)("div",{style:{backgroundColor:S.overlays.replyingPreview.background[E],borderLeft:"4px solid ".concat(S.overlays.replyingPreview.border[E])},className:"flex items-start gap-2 px-3 py-2 relative",children:(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{style:{color:S.overlays.replyingPreview.title[E]},className:"text-xs font-semibold",children:"replying"===Z.type?"Replying to":"Editing"}),(0,r.jsx)("button",{type:"button",className:"ml-auto","aria-label":"Cancel",onClick:()=>Q(null),children:(0,r.jsxs)("svg",{width:"18",height:"18",fill:"none",stroke:S.overlays.replyingPreview.closeIcon[E],strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,r.jsx)("div",{style:{color:S.overlays.replyingPreview.description[E]},className:"text-xs truncate max-w-xs",children:Z.description})]})}),(0,r.jsx)("div",{style:{backgroundColor:S.inputArea.background[E],borderColor:S.inputArea.border[E]},className:"p-4 border-t shrink-0",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=O.trim();if(t){var n;let e=null==Z||null==(n=Z.message)?void 0:n.id;if(e&&(null==Z?void 0:Z.type)==="editing"){null==h||h(e,t),Q(null),z("");return}d(t,e),z(""),e&&Q(null)}},className:"flex space-x-3",children:[(0,r.jsx)("input",{id:"chat-input",disabled:"connected"!==C,type:"text",value:O,onChange:e=>{z(e.target.value),u()},placeholder:"Type a message...",style:{backgroundColor:S.inputArea.inputBackground[E],color:S.inputArea.inputText[E],borderColor:S.inputArea.border[E]},className:"text-[16px] flex-grow p-3 border rounded-full",autoComplete:"off",required:!0}),(0,r.jsx)("button",{id:"send-button",type:"submit",disabled:!O.trim()||"connected"!==C,style:{backgroundColor:S.buttons.primary.background[E],color:S.buttons.primary.text[E],opacity:O.trim()&&"connected"===C?1:.5},className:"font-bold w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-colors",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),(0,r.jsx)("polyline",{points:"5 12 12 5 19 12"})]})})]})})]})]})}var ef=n(1368);let ex="https://animochat-turn-server.onrender.com",eb=()=>{let{setTheme:e,setMode:t}=ec(),[n,r]=(0,s.useState)("intro"),[a,i]=(0,s.useState)("initializing"),[o,l]=(0,s.useState)([]),[c,d]=(0,s.useState)(""),[u,g]=(0,s.useState)(""),[m,h]=(0,s.useState)(!1),f=(0,s.useRef)(null),x=(0,s.useRef)(null),b=(0,s.useRef)(!1);(0,s.useEffect)(()=>{let n=localStorage.getItem("animochat_user_id");if(n)d(n);else{let e=(0,ef.A)();localStorage.setItem("animochat_user_id",e),d(e)}return(async()=>{let a="".concat(ex,"/session/").concat(n);try{let s=await fetch(a);if(!s.ok)return void i("ready");let o=await s.json(),{chatId:l,serverUrl:c,participants:d}=o;if(!l||!c){console.log("No existing session found."),i("ready");return}console.log("Found existing session:",o),g(o.chatId);let u="".concat(c,"?userId=").concat(n,"&chatId=").concat(o.chatId);console.log("Connecting to WebSocket server: ".concat(u));let m=new WebSocket(u);f.current=m,e(Y),t("light"),F(m,o.chatId,[],!0),r("chat"),i("connecting"),console.log("Reconnected to chat: ".concat(o.chatId))}catch(e){console.error("Error fetching existing session:",e),i("error")}})(),()=>{var e,t;console.log("Cleaning up useAnimochat hook."),null==(e=x.current)||e.close(),null==(t=f.current)||t.close()}},[]);let p=(e,t,n)=>{console.log("Handling reaction:",{messageId:e,emoji:t,userId:n}),l(r=>r.map(r=>{let a;if(r.id!==e||"system"===r.type)return r;let s=r.reactions||[],i=s.findIndex(e=>e.user_id===n);return i>-1?t?(a=[...s])[i]={user_id:n,emoji:t,message_id:e}:a=s.filter((e,t)=>t!==i):a=t?[...s,{user_id:n,emoji:t,message_id:e}]:s,{...r,reactions:a}}))},y=(0,s.useCallback)(e=>{f.current&&f.current.readyState===WebSocket.OPEN?f.current.send(JSON.stringify(e)):console.error("Cannot send packet, WebSocket connection is not open.")},[]),k=(0,s.useCallback)(()=>{b.current||(b.current=!0,y({type:"typing",content:!0,sender:c}),setTimeout(()=>{b.current=!1,y({type:"typing",content:!1,sender:c})},3e3))},[c,y]),v=(0,s.useCallback)(async(e,t)=>{c&&(p(e,t||null,c),y({type:"reaction",sender:c,content:{message_id:e,emoji:t||null,user_id:c}}))},[c,y]),j=(0,s.useCallback)((e,t)=>{t&&e&&c&&(l(n=>n.map(n=>n.id===e?{...n,content:t,edited:!0}:n)),y({type:"edit_message",content:{message_id:e,new_content:t,user_id:c},sender:c}))},[c,y]),w=(0,s.useCallback)((e,t)=>{if(!c||!u)return;y({type:"typing",content:!1,sender:c});let n={id:"msg_".concat(Date.now()),session_id:u,created_at:new Date().toISOString(),content:e,replyingTo:t,sender:c};y({type:"message",content:n,sender:c}),l(e=>[...e,n])},[c,u,y]),N=(0,s.useCallback)(()=>{var e,t;(async()=>{let e="".concat(ex,"/session/disconnect?userId=").concat(c);try{let t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:c})});t.ok?console.log("Successfully disconnected from session."):console.error("Failed to disconnect from session:",t.statusText)}catch(e){console.error("Error disconnecting from session:",e)}})().then(()=>{console.log("Disconnected from matchmaking and chat.")}),f.current&&f.current.send(JSON.stringify({type:"disconnect",content:null,sender:c})),null==(e=f.current)||e.close(),f.current=null,null==(t=x.current)||t.close(),x.current=null,i("disconnected"),g("")},[c]),C=(0,s.useCallback)(e=>{if(console.log("Starting matchmaking with interests:",e),!c){console.error("User ID not set yet. Cannot start matchmaking."),i("error");return}r("chat"),i("finding_match");let t=e.join(","),n="".concat(ex,"/matchmaking?userId=").concat(c,"&interest=").concat(t);console.log("Connecting to matchmaking server: ".concat(n));let a=new EventSource(n);x.current=a,a.onmessage=e=>{let t=JSON.parse(e.data);if(console.log("Matchmaking update:",t),"MATCHED"===t.state&&t.chatId){var n;console.log("Match found with user ".concat(t.matchedUserId,"! ChatID: ").concat(t.chatId)),i("connecting"),a.close(),g(t.chatId);let e=t.chatServerUrl,r="".concat(e,"?userId=").concat(c,"&chatId=").concat(t.chatId);console.log("Connecting to WebSocket server: ".concat(r));let s=new WebSocket(r);f.current=s;let o=(null==(n=t.interest)?void 0:n.split(","))||[];F(s,t.chatId,o,!1)}else"WAITING"===t.state&&(console.log("Waiting for a match..."),i("waiting_for_match"))},a.onerror=e=>{console.error("EventSource failed:",e),i("error"),a.close()}},[c]),F=(0,s.useCallback)(function(n,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n.onopen=()=>{console.log("WebSocket connection established."),i("connected");let e="You matched with a stranger on ".concat(a.join(", "),"! Say hi!");s&&(e="Reconnected to chat with a stranger. Previous messages may not be visible yet."),l([{id:"system_".concat(Date.now()),session_id:r,created_at:new Date().toISOString(),type:"system",content:e,sender:"system"}])},n.onmessage=async a=>{let s,o=a.data,d=s=o instanceof Blob?JSON.parse(await o.text()):"string"==typeof o?JSON.parse(o):o;if(console.log("Received packet:",s),d.sender!==c)switch(console.log("Packet sender: ",d.sender),console.log("Current user ID: ",c),d.type){case"change_theme":console.log("Received change theme packet from server.");let{mode:u,theme:m}=d.content;t(u),e(m);let b={id:"system_".concat(Date.now()),session_id:r,created_at:new Date().toISOString(),type:"system",content:"Theme changed to ".concat(m.name," in ").concat(u," mode."),sender:"system"};l(e=>[...e,b]);break;case"offline":console.log("Received offline packet from server.");let y=d.content!==c,k={id:"system_".concat(Date.now()),session_id:r,created_at:new Date().toISOString(),type:"system",content:y?"Your partner has went offline.":"You are currently offline.",sender:"system"};l(e=>[...e,k]);break;case"disconnect":var v;console.log("Received disconnect packet from server."),i("disconnected");let j={id:"system_".concat(Date.now()),session_id:r,created_at:new Date().toISOString(),type:"system",content:"The other user has disconnected.",sender:"system"};l(e=>[...e,j]),n.close(),f.current=null,null==(v=x.current)||v.close(),x.current=null,g("");break;case"STATUS":let w={id:"system_".concat(Date.now()),session_id:r,created_at:new Date().toISOString(),type:"system",content:d.message,sender:"system"};l(e=>[...e,w]);break;case"message":l(e=>[...e,d.content]);break;case"reaction":let{message_id:N,emoji:C,user_id:F}=d.content;p(N,C,F);break;case"typing":if(d.sender===c)return;h(d.content);break;case"edit_message":let{message_id:S,new_content:E,user_id:T}=d.content;l(e=>e.map(e=>e.id===S&&e.sender===T?{...e,content:E,edited:!0}:e));break;default:console.warn("Unknown packet type received:",d.type);let _={id:"system_".concat(Date.now()),session_id:r,created_at:new Date().toISOString(),type:"system",content:"Unknown packet type received: ".concat(d.type," there is probably a new version of the site available. Please refresh the page."),sender:"system"};l(e=>[...e,_])}},n.onclose=()=>{console.log("WebSocket connection closed."),i("disconnected");let e={id:"system_".concat(Date.now()),session_id:r,created_at:new Date().toISOString(),type:"system",content:"The connection has been closed.",sender:"system"};l(t=>[...t,e])},n.onerror=e=>{console.error("WebSocket error:",e),i("error")}},[c,u,p]);return{screen:n,status:a,messages:o,userId:c,isStrangerTyping:m,handleGetStarted:()=>r("matchmaking"),startMatchmaking:C,onCancelMatchmaking:()=>{console.log("Cancelling matchmaking..."),x.current&&(x.current.close(),x.current=null),i("ready"),r("matchmaking"),g("")},sendMessage:w,disconnect:N,onReact:v,onChangeTheme:(n,r)=>{if(console.log("THEME CHANGE REQUESTED"),!c||!u)return;y({type:"change_theme",content:{mode:n,theme:r},sender:c}),t(n),e(r);let a={id:"system_".concat(Date.now()),session_id:u,created_at:new Date().toISOString(),type:"system",content:"Theme changed to ".concat(r.name," in ").concat(n," mode."),sender:"system"};l(e=>[...e,a])},editMessage:j,onStartTyping:k}};function ep(){let{screen:e,userId:t,status:n,messages:i,startMatchmaking:o,onChangeTheme:l,disconnect:c,editMessage:d,sendMessage:u,onReact:m,onCancelMatchmaking:h,onStartTyping:f,handleGetStarted:x,isStrangerTyping:y}=eb(),[k,v]=(0,s.useState)(new Set),j=e=>{if(0===e.size)return void x();o(Array.from(e))},w={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.23,ease:"easeInOut"}};return(0,r.jsx)("div",{className:"h-full overflow-y-auto overflow-x-hidden",children:(0,r.jsxs)("main",{className:"container h-full mx-auto flex flex-col ".concat("chat"===e?"p-0":"px-4 py-8 md:py-16"),children:["chat"!==e&&(0,r.jsx)(a,{}),(0,r.jsx)("div",{className:"flex-grow flex flex-col justify-center items-center",children:(0,r.jsx)(p.N,{mode:"wait",children:(()=>{switch(e){case"chat":return(0,r.jsx)(b.P.div,{...w,className:"h-full w-full flex items-center justify-center sm:p-4",children:(0,r.jsx)(eh,{goBack:()=>{x()},onEditMessage:d,onStartTyping:f,cancelMatchmaking:h,isStrangerTyping:y,onReact:m,onChangeTheme:l,messages:i,sendMessage:u,newChat:()=>{j(k)},endChat:c,peerId:t,status:n})},"chat");case"matchmaking":return(0,r.jsxs)(b.P.div,{...w,className:"w-full h-full flex flex-col justify-center items-center",children:[(0,r.jsx)("div",{className:"max-w-3xl mx-auto relative w-full",children:(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("h2",{className:"text-4xl md:text-6xl font-bold bg-gradient-to-r from-green-600 to-green-400 bg-clip-text text-transparent",children:"Choose Your Interests"}),(0,r.jsx)("p",{className:"text-gray-600 text-lg my-8",children:"Find someone to chat with based on what you like."})]})}),(0,r.jsx)(F,{interests:k,onInterestsChange:v,onFindMatch:j,isConnecting:!1,status:n})]},"matchmaking");default:return(0,r.jsxs)(b.P.div,{...w,className:"w-full h-full flex flex-col justify-center items-center",children:[(0,r.jsx)("div",{className:"max-w-3xl mx-auto relative w-full",children:(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsxs)("h2",{className:"text-4xl md:text-6xl font-bold bg-gradient-to-r from-green-600 to-green-400 bg-clip-text text-transparent",children:["Real-time",(0,r.jsx)("br",{}),"Anonymous Chat"]}),(0,r.jsx)("p",{className:"text-gray-600 text-lg my-8",children:"Connect with students anonymously and securely."})]})}),(0,r.jsx)("div",{className:"max-w-md mx-auto text-sm space-y-6 text-center",children:(0,r.jsx)("div",{className:"text-red-700 bg-red-50 p-4 rounded-2xl border border-red-200 font-medium",children:(0,r.jsx)("p",{children:"This is a test version of AnimoChat. Not all features are implemented, and you may encounter bugs."})})}),(0,r.jsx)("div",{className:"text-center mt-12",children:(0,r.jsx)(g,{onClick:x,size:"lg",className:"rounded-full py-7 px-8 bg-green-600 hover:bg-green-700 text-white font-bold text-lg",children:"Get Started"})})]},"intro")}})()})}),"chat"!==e&&(0,r.jsxs)("footer",{className:"text-xs text-gray-500 text-center py-4 shrink-0",children:[(0,r.jsxs)("h3",{className:"py-4",children:["Created by developers from"," ",(0,r.jsx)("span",{className:"text-green-700 font-semibold",children:"De La Salle Lipa"})]}),t&&(0,r.jsxs)("p",{className:"font-mono text-gray-400 text-[10px] mt-2",children:["Your User ID: ",t]})]})]})})}let ey=e=>{let{className:t=""}=e;return(0,r.jsx)("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})})},ek=e=>{let{size:t=24,className:n=""}=e;return(0,r.jsxs)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,r.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})},ev=e=>{let{size:t=32,className:n=""}=e;return(0,r.jsxs)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1"}),(0,r.jsx)("line",{x1:"12",y1:"7",x2:"12",y2:"13"}),(0,r.jsx)("line",{x1:"9",y1:"10",x2:"15",y2:"10"})]})},ej=()=>(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),ew=e=>{let{isOpen:t,onClose:n,onSubmit:a}=e,[i,o]=(0,s.useState)(""),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(!1),f=(0,s.useRef)(null);if((0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),(0,s.useEffect)(()=>{if(t){var e;null==(e=f.current)||e.focus(),o(""),c(!1),u(null),h(!1)}},[t]),!t)return null;let x=async e=>{if(e.preventDefault(),!i.trim())return void u("Feedback cannot be empty.");c(!0),u(null);try{await a(i),h(!0),setTimeout(()=>{n()},2e3)}catch(e){u("Failed to submit feedback. Please try again."),console.error(e)}finally{c(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center","aria-modal":"true",role:"dialog",children:(0,r.jsxs)("div",{ref:f,tabIndex:-1,className:"bg-white rounded-2xl shadow-2xl w-full max-w-md m-4 p-8 relative",children:[(0,r.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close dialog",children:(0,r.jsx)(ek,{size:24})}),(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("div",{className:"bg-green-100 p-3 rounded-full mb-4",children:(0,r.jsx)(ev,{className:"text-green-600",size:32})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Got a suggestion?"}),(0,r.jsx)("p",{className:"text-gray-500 mb-6",children:"We'd love to hear your ideas for new features or improvements."})]}),m?(0,r.jsx)("div",{className:"text-center p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsx)("p",{className:"font-semibold text-green-700",children:"Thank you! Your feedback has been submitted."})}):(0,r.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"feedback-content",className:"sr-only",children:"Your suggestion"}),(0,r.jsx)("textarea",{id:"feedback-content",value:i,onChange:e=>o(e.target.value),placeholder:"Type your suggestion here...",className:"w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",required:!0})]}),d&&(0,r.jsx)("p",{className:"text-red-600 text-sm text-center",children:d}),(0,r.jsxs)(g,{type:"submit",disabled:l,className:"w-full rounded-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold text-base disabled:bg-gray-400 disabled:cursor-wait flex items-center justify-center transition-colors",children:[l&&(0,r.jsx)(ej,{}),l?"Submitting...":"Submit Feedback"]})]})]})})},eN=()=>{let[e,t]=(0,s.useState)(!1),n=async e=>{console.log("Submitting feedback:",e),await new Promise(e=>setTimeout(e,1e3))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("style",{children:"\n        @keyframes gentle-wrench-turn {\n          0%, 100% { transform: rotate(-8deg); }\n          50% { transform: rotate(8deg); }\n        }\n        .animate-wrench {\n          animation: gentle-wrench-turn 3s ease-in-out infinite;\n        }\n\n        @keyframes progress-bar-shine {\n          0% { transform: translateX(-100%) skewX(-30deg); }\n          100% { transform: translateX(350%) skewX(-30deg); }\n        }\n        .progress-shine::after {\n          content: '';\n          position: absolute;\n          top: 0;\n          left: 0;\n          width: 33%;\n          height: 100%;\n          background: rgba(255, 255, 255, 0.4);\n          animation: progress-bar-shine 2.5s infinite linear;\n        }\n      "}),(0,r.jsxs)("div",{className:"bg-gray-50 min-h-screen flex flex-col items-center justify-center text-center p-4 font-sans overflow-hidden",children:[(0,r.jsxs)("div",{className:"max-w-md w-full bg-white p-8 sm:p-10 rounded-2xl shadow-xl border border-gray-200",children:[(0,r.jsx)("div",{className:"mx-auto bg-green-100 p-4 rounded-full w-20 h-20 flex items-center justify-center mb-6 animate-wrench",children:(0,r.jsx)(ey,{className:"w-10 h-10 text-green-600"})}),(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"Under Maintenance"}),(0,r.jsx)("p",{className:"text-lg text-gray-600 mb-4",children:"We'll be back up soon!"}),(0,r.jsx)("p",{className:"text-md text-gray-500 mb-8",children:"We're just polishing things up to make your experience even better."}),(0,r.jsx)("div",{className:"w-full bg-green-200 rounded-full h-4 mb-8 overflow-hidden relative",children:(0,r.jsx)("div",{className:"bg-green-500 h-4 rounded-full w-3/4 progress-shine"})}),(0,r.jsx)("button",{onClick:()=>t(!0),className:"px-8 py-3 bg-green-600 text-white font-semibold rounded-full hover:bg-green-700 transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Leave Feedback"})]}),(0,r.jsx)("p",{className:"mt-8 text-sm text-gray-400",children:"Patience is a virtue, and so is great software!"})]}),(0,r.jsx)(ew,{isOpen:e,onClose:()=>t(!1),onSubmit:n})]})},eC=()=>{let[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)(!0),[a,i]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("https://animochat-turn-server.onrender.com/maintenance");if(503===e.status)t(!0);else if(e.ok){let n=await e.json();"MAINTENANCE"===n.state?t(!0):t(!1)}else throw Error("Failed to fetch status: ".concat(e.statusText))}catch(n){console.error("Failed to check maintenance status:",n);let e=n instanceof Error?n.message:"An unknown error occurred.";i("Could not connect to the service. Please try again later. (".concat(e,")")),t(!0)}finally{r(!1)}})()},[]),{isMaintenanceMode:e,isLoading:n,error:a}};function eF(){let{isMaintenanceMode:e,isLoading:t,error:n}=eC();return t?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"Checking service status..."})}):e?(0,r.jsx)(eN,{}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(el,{children:(0,r.jsx)(ep,{})})})}},6379:(e,t,n)=>{Promise.resolve().then(n.bind(n,5909))},9732:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[817,477,441,684,358],()=>t(6379)),_N_E=e.O()}]);