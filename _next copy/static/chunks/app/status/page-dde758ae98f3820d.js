(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[557],{4272:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>M});var a=t(5155),r=t(2115),l=t(9946);let i=(0,l.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),c=(0,l.A)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]),n=(0,l.A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),d=(0,l.A)("memory-stick",[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]]),o=(0,l.A)("warehouse",[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]]);var h=t(5487),x=t(7580);let m=(0,l.A)("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),u=(0,l.A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var y=t(9545);let v=(0,l.A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),p=(0,l.A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),g=e=>{let{status:s}=e,t="ERROR";"ACTIVE"===s||"RUNNING"===s||"ready"===s?t="ACTIVE":"MAINTENANCE"===s&&(t="MAINTENANCE");let r="ACTIVE"===t?"bg-green-500":"MAINTENANCE"===t?"bg-yellow-500":"bg-red-500",l=t.charAt(0)+t.slice(1).toLowerCase();return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"h-3 w-3 rounded-full ".concat(r)}),(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-700",children:l})]})},j=e=>{let{icon:s,title:t,value:r}=e;return(0,a.jsxs)("div",{className:"bg-green-50/50 p-4 rounded-lg flex items-center gap-4",children:[(0,a.jsx)("div",{className:"bg-green-100 p-3 rounded-full",children:s}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:t}),(0,a.jsx)("p",{className:"text-xl font-bold text-gray-800",children:r})]})]})},f=e=>{let{icon:s,label:t,value:r}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-gray-100 p-2 rounded-md",children:[(0,a.jsx)("div",{className:"text-gray-500",children:s}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:t}),(0,a.jsx)("div",{className:"text-sm font-semibold text-gray-800",children:null!=r?r:"N/A"})]})]})},N=e=>{var s,t;let{os:r,processMemory:l}=e;return r||l?(0,a.jsx)("div",{className:"px-4 pb-4",children:(0,a.jsxs)("details",{className:"group",children:[(0,a.jsxs)("summary",{className:"list-none flex items-center justify-between cursor-pointer text-sm font-semibold text-gray-600 hover:text-gray-900",children:[(0,a.jsx)("span",{children:"System Metrics"}),(0,a.jsx)(i,{className:"h-5 w-5 transition-transform group-open:rotate-180"})]}),(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 text-sm",children:[r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{icon:(0,a.jsx)(c,{size:16}),label:"CPUs",value:r.cpuCount}),(0,a.jsx)(f,{icon:(0,a.jsx)(n,{size:16}),label:"Load (1m)",value:null==(t=r.loadAverage)||null==(s=t[0])?void 0:s.toFixed(2)}),(0,a.jsx)(f,{icon:(0,a.jsx)(d,{size:16}),label:"Total Memory",value:r.totalMemory}),(0,a.jsx)(f,{icon:(0,a.jsx)(d,{size:16}),label:"Free Memory",value:r.freeMemory})]}),l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{icon:(0,a.jsx)(o,{size:16}),label:"RSS",value:l.rss.split(" ")[0]}),(0,a.jsx)(f,{icon:(0,a.jsx)(o,{size:16}),label:"Heap Used",value:l.heapUsed.split(" ")[0]})]})]})]})}):null},b=e=>{let{status:s}=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(h.A,{className:"text-gray-500"}),(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:s.serviceInfo.serviceName}),(0,a.jsx)("span",{className:"text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded-full font-mono",children:s.serviceInfo.version})]}),(0,a.jsx)(g,{status:s.serviceState})]}),(0,a.jsxs)("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(j,{icon:(0,a.jsx)(x.A,{size:20,className:"text-green-700"}),title:"Users in Queue",value:s.metrics.usersInQueue}),(0,a.jsx)(j,{icon:(0,a.jsx)(m,{size:20,className:"text-green-700"}),title:"Active Sessions",value:s.metrics.activeSessions}),(0,a.jsx)(j,{icon:(0,a.jsx)(u,{size:20,className:"text-green-700"}),title:"Redis Commands",value:s.redis.commands}),(0,a.jsx)(j,{icon:(0,a.jsx)(u,{size:20,className:"text-green-700"}),title:"Redis Subscriber",value:s.redis.subscriber})]}),(0,a.jsx)("div",{className:"flex-grow"}),(0,a.jsx)(N,{os:s.os,processMemory:s.processMemory}),(0,a.jsxs)("div",{className:"p-2 bg-gray-50 border-t text-right text-xs text-gray-400",children:["Last updated: ",new Date(s.timestamp).toLocaleTimeString()]})]})},k=e=>{let{status:s}=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(h.A,{className:"text-gray-500"}),(0,a.jsx)("h3",{className:"font-bold text-lg text-gray-800",children:s.serviceInfo.serviceName}),(0,a.jsx)("span",{className:"text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded-full font-mono",children:s.serviceInfo.version})]}),(0,a.jsx)(g,{status:s.serviceState})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)(j,{icon:(0,a.jsx)(o,{size:20,className:"text-green-700"}),title:"Total Rooms",value:s.totalRooms}),s.totalRooms>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-gray-700",children:"Active Rooms"}),(0,a.jsx)("div",{className:"max-h-40 overflow-y-auto rounded-md border",children:(0,a.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,a.jsx)("thead",{className:"bg-gray-100 sticky top-0",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-2 font-semibold",children:"Chat ID"}),(0,a.jsx)("th",{className:"p-2 font-semibold",children:"Participants"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:s.rooms.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{className:"p-2 font-mono text-xs truncate",title:e.chatId,children:[e.chatId.substring(0,12),"..."]}),(0,a.jsx)("td",{className:"p-2",children:e.participants})]},e.chatId))})]})})]})]}),(0,a.jsx)("div",{className:"flex-grow"}),(0,a.jsx)(N,{os:s.os,processMemory:s.processMemory})]})},w=e=>{let{error:s}=e;return(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-4",children:[(0,a.jsx)(y.A,{className:"text-red-500 h-8 w-8"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-red-800",children:s.serviceInfo.serviceName||"Unknown Service"}),(0,a.jsx)("p",{className:"text-sm text-red-700",children:s.message}),(0,a.jsx)("p",{className:"text-xs text-red-600 font-mono",children:s.serviceInfo.url})]})]})};function M(){let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!0),[i,c]=(0,r.useState)(null),[n,d]=(0,r.useState)(null),o=(0,r.useCallback)(async()=>{l(!0),c(null);try{let e=await fetch("https://animochat-service-discovery.onrender.com/services");if(!e.ok)throw Error("Failed to fetch from discovery server. Status: ".concat(e.status));let t=await e.json(),a=Object.values(t).map(e=>Object.values(e)).flat(2);if(0===a.length){s([]),d(new Date),l(!1);return}let r=a.map(async e=>{try{let s=await fetch("".concat(e.url,"/status"));if(!s.ok)throw Error("Request failed with status ".concat(s.status));let t=await s.json();if(t.metrics&&void 0!==t.metrics.usersInQueue)return{type:"matchmaking",data:t};if(void 0!==t.totalRooms)return{type:"chat",data:{...t,serviceInfo:{serviceName:e.serviceName,version:e.version},serviceState:e.status}};throw Error("Unknown status response format")}catch(s){return{type:"error",message:s.message||"Failed to fetch status",serviceInfo:e}}}),i=await Promise.all(r);s(i),d(new Date)}catch(e){c(e.message||"An unknown error occurred."),console.error(e)}finally{l(!1)}},[]);return(0,r.useEffect)(()=>{o();let e=setInterval(o,15e3);return()=>clearInterval(e)},[o]),(0,a.jsx)("div",{className:"bg-gray-50 min-h-screen text-gray-800",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("header",{className:"mb-8 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-green-700",children:"Service Status"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:n?"Last updated: ".concat(n.toLocaleTimeString()):"Loading status..."})]}),(0,a.jsx)("button",{onClick:o,disabled:t,className:"p-2 rounded-full hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-wait","aria-label":"Refresh Status",children:(0,a.jsx)(v,{className:"h-6 w-6 text-gray-600 ".concat(t?"animate-spin":"")})})]}),i&&(0,a.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md mb-6 flex items-center gap-3",children:[(0,a.jsx)(p,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-bold",children:"Discovery Error"}),(0,a.jsx)("p",{children:i})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.map((e,s)=>{switch(e.type){case"matchmaking":return(0,a.jsx)(b,{status:e.data},"".concat(e.data.serviceInfo.serviceName,"-").concat(s));case"chat":return(0,a.jsx)(k,{status:e.data},"".concat(e.data.serviceInfo.serviceName,"-").concat(s));case"error":return(0,a.jsx)(w,{error:e},"".concat(e.serviceInfo.serviceName,"-").concat(s));default:return null}})}),!t&&0===e.length&&!i&&(0,a.jsxs)("div",{className:"text-center py-16 text-gray-500",children:[(0,a.jsx)(h.A,{className:"mx-auto h-12 w-12 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"No services found"}),(0,a.jsx)("p",{children:"The discovery server did not return any active services."})]})]})})}},5487:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]])},6214:(e,s,t)=>{Promise.resolve().then(t.bind(t,4272))},7580:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},9545:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("server-crash",[["path",{d:"M6 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2",key:"4b9dqc"}],["path",{d:"M6 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-2",key:"22nnkd"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m13 6-4 6h6l-4 6",key:"14hqih"}]])},9946:(e,s,t)=>{"use strict";t.d(s,{A:()=>h});var a=t(2115);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase()),i=e=>{let s=l(e);return s.charAt(0).toUpperCase()+s.slice(1)},c=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim()},n=e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,s)=>{let{color:t="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:o="",children:h,iconNode:x,...m}=e;return(0,a.createElement)("svg",{ref:s,...d,width:r,height:r,stroke:t,strokeWidth:i?24*Number(l)/Number(r):l,className:c("lucide",o),...!h&&!n(m)&&{"aria-hidden":"true"},...m},[...x.map(e=>{let[s,t]=e;return(0,a.createElement)(s,t)}),...Array.isArray(h)?h:[h]])}),h=(e,s)=>{let t=(0,a.forwardRef)((t,l)=>{let{className:n,...d}=t;return(0,a.createElement)(o,{ref:l,iconNode:s,className:c("lucide-".concat(r(i(e))),"lucide-".concat(e),n),...d})});return t.displayName=i(e),t}}},e=>{var s=s=>e(e.s=s);e.O(0,[441,684,358],()=>s(6214)),_N_E=e.O()}]);